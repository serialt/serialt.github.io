<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>wlan - Blog</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="wlan" />
<meta property="og:description" content="wlan组网 一、概述 无线局域网(Wireless Local Area Networks； WLAN)利用无线技术在空中传输数据、话音和视频信号。作为传统布线网络" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://serialt.github.io/posts/2024-03-24-wlan/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-23T22:16:02+08:00" />
<meta property="article:modified_time" content="2024-03-23T22:16:02+08:00" /><meta property="og:site_name" content="Log" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="wlan"/>
<meta name="twitter:description" content="wlan组网 一、概述 无线局域网(Wireless Local Area Networks； WLAN)利用无线技术在空中传输数据、话音和视频信号。作为传统布线网络"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://serialt.github.io/posts/2024-03-24-wlan/" /><link rel="prev" href="https://serialt.github.io/posts/2024-03-24-route-switch-base/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "wlan",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/serialt.github.io\/posts\/2024-03-24-wlan\/"
        },"genre": "posts","keywords": "network, ap, ac","wordcount":  3431 ,
        "url": "https:\/\/serialt.github.io\/posts\/2024-03-24-wlan\/","datePublished": "2024-03-23T22:16:02+08:00","dateModified": "2024-03-23T22:16:02+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "serialt"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Blog">记录</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Blog">记录</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">wlan</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>serialt</a></span>&nbsp;<span class="post-category">included in <a href="/categories/network/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Network</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-03-23">2024-03-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;3431 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;7 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#wlan组网">wlan组网</a>
      <ul>
        <li><a href="#一概述">一、概述</a></li>
        <li><a href="#二80211基本元素">二、802.11基本元素</a></li>
        <li><a href="#三wlan拓扑结构">三、WLAN拓扑结构</a></li>
        <li><a href="#四ap">四、AP</a></li>
        <li><a href="#五capwap简介">五、CAPWAP简介</a></li>
        <li><a href="#六ap和ac工作过程">六、AP和AC工作过程</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="wlan组网">wlan组网</h2>
<h3 id="一概述">一、概述</h3>
<p>无线局域网(Wireless Local Area Networks； WLAN)利用无线技术在空中传输数据、话音和视频信号。作为传统布线网络的一种替代方案或延伸，无线局域网把个人从办公桌边解放了出来，使他们可以随时随地获取信息，提高了员工的办公效率。
WLAN的优点：它能够方便地联网，因为WLAN可以便捷、迅速地接纳新加入的雇员，而不必对网络的用户管理配置进行过多的变动；WLAN在有线网络布线困难的地方比较容易实施，使用WLAN方案，则不必再实施打孔敷线作业，因而不会对建筑设施造成任何损害。</p>
<h3 id="二80211基本元素">二、802.11基本元素</h3>
<p>基本服务器(Basic Service Set)是802.11网络的基本组件，由一组相互通信的工作站所构成。工作站之间的通信在某个模糊地带进行，称为基本服务区域(Basic Service Area)，此区域受限于所使用的无线媒介的传播特性</p>
<p>BSA：BSS的覆盖范围称为基本服务区</p>
<p>BSS分为Independent BSS和Infrastructure BSS两种</p>
<p>独立服务集简称IBSS，工作站之间可以直接通信，但两者间的距离必须在可以通信的范围内。</p>
<p>由于持续时间不长，规模小且目的特殊，IBSS有时称为特设BSS或ad hoc newwork</p>
<p>基础架构模式基本服务集。判断是否为基础结构型网络，只要查看是否有接入点(AP)参与其中</p>
<p>ESS：利用骨干网络将BSS进行连接</p>
<p>SSID：用户的网络名称</p>
<p>BSSID：AP的MAC地址，用来标识AP所管理的BSS</p>
<h3 id="三wlan拓扑结构">三、WLAN拓扑结构</h3>
<p><strong>3.1 Ad-Hoc</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70.png"
        title="在这里插入图片描述" width="959" height="411" /></p>
<p>Ad-Hoc拓扑的无线网络由无线工作站组成，用于一台无线工作站和另一台或多台其他无线工作站的直接通讯，该网络无法接入到有线网络中，只能独立使用
<strong>3.2 IBSS</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153205147.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153205147.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153205147.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153205147.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153205147.png"
        title="在这里插入图片描述" width="1008" height="437" /></p>
<p>由多个AP以及连接他们的分布式系统(DS)组成的基础架构模式网络，也称为扩展服务区(ESS)。扩展服务区内的每个AP都是一个独立的无线网络基础服务区(BSS)，所有AP共享同一个扩展服务区标识符(ESSID)
相同ESSID的无线网络可以进行漫游，不同ESSID的无线网络形成逻辑子网
AP之间使用互相不重叠的信道，AP之间信号覆盖重叠区域为10%-15%
<strong>3.3 WDS</strong>
WDS(Wireless Distribution System无线分布式系统)：通过无线链路链接两个或者多个独立的有线局域网或者无线局域网，组成一个互通的网络
无线WDS技术提高了整个网络结构的灵活性和便捷性
在WDS部署中，网桥组网模式可分为：
点对点(P2P)
点对多点(P2MP)
中继桥接方式</p>
<h3 id="四ap">四、AP</h3>
<p><strong>4.1 概述</strong>
无线局域网的架构主要分为
基于控制器的AP架构(瘦AP，FitAP)
传统的独立AP架构(胖AP，FatAP)
近几年WLAN技术的发展，瘦AP正在迅速替代胖AP模式
<strong>4.2 胖AP</strong>
除无线接入功能外，一般具备WLAN、LAN两个接口，多支持DHCP服务器、DNS和MAC地址克隆，以及VPN接入、防火墙等安全功能
胖AP也称为独立AP，所有的配置存储于自治型接入点本身，因此设备的管理和配置均由接入点处理。所有加解密和MAC层功能也由自治型接入点完成
胖AP的例子典型的是无线路由器
<strong>4.3 瘦AP</strong>
无线局域网一体化发展的下一个阶段是集中式WLAN架构。这种模式使用位于网络核心的WLAN控制器，在集中式的无线局域网体系结构中，基于控制器的接入点，也称为轻量型AP</p>
<p>为了实现WLAN网络的快速部署、网络设备的集中管理、精细化的用户管理，相比胖AP方式，企业用户以及运营商更倾向于采用集中控制性WLAN组网(瘦AP+AC)</p>
<p>AC和AP之间采用CAPWAP协议</p>
<h3 id="五capwap简介">五、CAPWAP简介</h3>
<p>CAPWAP(无线接入点控制和配置协议)，用于无线终端接入点(AP)和无线网络控制器(AC)之间的通信和交互，实现AC对其所关联的AP的集中管理和控制
协议内容
AP对AC的自动发现以及AP&amp;AC的状态机运行、维护
AC对AP进行管理、业务配置下发
STA数据封装CAPWAP隧道进行转发</p>
<h3 id="六ap和ac工作过程">六、AP和AC工作过程</h3>
<p><strong>6.1 瘦AP发现AC</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153336805.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153336805.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153336805.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153336805.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153336805.png"
        title="在这里插入图片描述" width="968" height="533" /></p>
<p>6.2 AP和AC详细工作过程
6.2.1 动态发现</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153353243.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153353243.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153353243.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153353243.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153353243.png"
        title="在这里插入图片描述" width="936" height="503" /></p>
<p>AP启动以后会通过DHCP获取IP地址、DNS Server、域名
AP发出L2广播的发现请求报文试图联系一个AC
如果长时间(30秒)没有响应，AP会启动L3发现。AP会从DHCP Server通过Option43获得AC的IP，或者通过Opthion15获得AC的域名，AP向该IP地址(域名)发送请求
接收到发现请求报文的AC会检查该AP是否接入本机的权限，如果有则回应发现响应
AC和AP间建立CAPWAP隧道
6.2.2 CAPWAP隧道建立过程
DHCP</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153425382.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153425382.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153425382.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153425382.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153425382.png"
        title="在这里插入图片描述" width="845" height="325" /></p>
<p>CAPWAP隧道建立-Discover</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153450401.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153450401.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153450401.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907153450401.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907153450401.png"
        title="在这里插入图片描述" width="701" height="247" /></p>
<p>AP使用AP发现机制来获取哪些AC可用，决定与最佳AC建立CAPWAP连接。(当AP上已经静态配置了AC，那么就不需要完成AC的发现过程)
AP启动CAPWAP协议的发现机制，以单播或广播的形式发送请求报文试图关联AC，AC收到AP的discovery Request以后，会发送一个单播的discovery response给AP，AP可以通过discovery response中所带的AC优先级或者AC上当前AP的个数等，确定与哪个AC建立会话
CAPWAP隧道建立-DTLS(可选)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160329081.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160329081.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160329081.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160329081.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160329081.png"
        title="在这里插入图片描述" width="702" height="254" /></p>
<p>AP根据此IP地址与AC协商，AP接受到响应消息后开始与AC建立CAPWAP隧道，这个阶段可以选择CAPWAP隧道是否采用DTLS加密传输UDP报文
DTLS：Datagram Transport Layer Security(数据报传输层安全协议)
CAPWAP隧道建立-Join</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160355307.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160355307.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160355307.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160355307.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160355307.png"
        title="在这里插入图片描述" width="716" height="252" /></p>
<p>在完成DTLS握手后，AC与AP开始建立控制隧道，在建立控制隧道的交互过程中，AC回应的Join Response报文中会携带用户配置的升级版本号，握手报文间隔/超时时间，控制报文优先级等信息。AC会检查AP的当前版本，如果AP的版本无法与AC要求的相匹配，AP和AC会进入Image Data状态做固件升级，以此来更新AP的版本，如果AP的版本符合要求，则进入Configuration状态
CAPWAP隧道建立-Configure</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160417192.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160417192.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160417192.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160417192.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160417192.png"
        title="在这里插入图片描述" width="702" height="248" /></p>
<p>将入Configure状态后为了做AP的现有配置和AC设定配置的匹配检查，AP发送Configuration Request到AC，该信息中包含现有AP的配置，当AP当前配置与AC要求不符时，AC通过Configuration Response通知AP
CAPWAP隧道建立-data check</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160435577.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160435577.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160435577.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160435577.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160435577.png"
        title="在这里插入图片描述" width="709" height="255" /></p>
<p>进入run状态，他们之间会发送keeplive报文来维护数据隧道</p>
<h4 id="七综合实验">七、综合实验</h4>
<p>7.1 实验组网</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160456531.png"
        data-srcset="/posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160456531.png, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160456531.png 1.5x, /posts/2024-03-24-wlan/images/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5%2csize_16%2ccolor_FFFFFF%2ct_70-20230907160456531.png 2x"
        data-sizes="auto"
        alt="/posts/2024-03-24-wlan/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjEzMDI5,size_16,color_FFFFFF,t_70-20230907160456531.png"
        title="在这里插入图片描述" width="1037" height="529" /></p>
<p>7.2 实验配置</p>
<h4 id="721-瘦ap配置">7.2.1 瘦AP配置</h4>
<p>1、划分vlan10 20，vlan10用于管理，vlan20用于业务</p>
<p>2、LSW4的配置</p>
<pre tabindex="0"><code>&lt;Huawei&gt;undo terminal monitor 
&lt;Huawei&gt;sys
[Huawei]vlan batch 10 20 
[Huawei]int g0/0/2
[Huawei-GigabitEthernet0/0/2]port link-type trunk 
[Huawei-GigabitEthernet0/0/2]port trunk allow-pass vlan 10 20
[Huawei-GigabitEthernet0/0/2]port trunk pvid vlan 10
[Huawei-GigabitEthernet0/0/3]int g0/0/1
[Huawei-GigabitEthernet0/0/1]port link-type trunk 
[Huawei-GigabitEthernet0/0/1]port trunk allow-pass vlan 10 20
</code></pre><p>3、LSW3的配置</p>
<pre tabindex="0"><code>[Huawei]int g0/0/1
[Huawei-GigabitEthernet0/0/1]port link-type trunk 
[Huawei-GigabitEthernet0/0/1]port trunk allow-pass vlan 10 20
[Huawei-GigabitEthernet0/0/1]int g0/0/3
[Huawei-GigabitEthernet0/0/3]port link-type trunk 
[Huawei-GigabitEthernet0/0/3]port trunk allow-pass vlan 10 20
</code></pre><p>4、AC配置</p>
<pre tabindex="0"><code>[AC6005]vlan batch 10 20
[AC6005-GigabitEthernet0/0/1]port link-type trunk 
[AC6005-GigabitEthernet0/0/1]port trunk allow-pass vlan 10 20
[AC6005-GigabitEthernet0/0/1]q
//配置dhcp
[AC6005]dhcp enable
[AC6005]int Vlanif 10
[AC6005-Vlanif10]ip address 10.1.10.1 24
[AC6005-Vlanif10]dhcp select interface 
[AC6005-Vlanif10]int vlanif 20
[AC6005-Vlanif20]ip address 10.1.20.1 24
[AC6005-Vlanif20]dhcp select interface 
[AC6005-Vlanif20]q
//在AC上配置AP上线
//创建AP组，用于将相同配置的AP加入到同一AP组
[AC6005]wlan
[AC6005-wlan-view]ap-group name ap-group1
[AC6005-wlan-ap-group-ap-group1]q
//创建域管理模板，在域管理模板配置AC的国家码并在AP组下引用管理模块
[AC6005-wlan-view]regulatory-domain-profile name defult
[AC6005-wlan-regulate-domain-defult]country-code cn
[AC6005-wlan-regulate-domain-defult]q
[AC6005-wlan-view]ap-group name ap-group1	
[AC6005-wlan-ap-group-ap-group1]regulatory-domain-profile default
Warning: Modifying the country code will clear channel, power and antenna gain c
onfigurations of the radio and reset the AP. Continue?[Y/N]:y
[AC6005-wlan-ap-group-ap-group1]q
[AC6005-wlan-view]q
//配置AC源接口
[AC6005]capwap source int Vlanif 10
//查看AP2的MAC地址，并记录下来
[AC6005]wlan 
[AC6005-wlan-view]ap auth-mode mac-auth 
[AC6005-wlan-view]ap-id	0 ap-mac [ap2的mac地址]
[AC6005-wlan-ap-0]ap-name area_1
[AC6005-wlan-ap-0]ap-group ap-group1
[AC6005-wlan-ap-0]q
//配置WLAN业务参数，配置WPA-WPA2+PSK+AES
[AC6005]wlan 
[AC6005-wlan-view]security-profile name wlan-net
[AC6005-wlan-sec-prof-wlan-net]security wpa-wpa2 psk pass-phrase 12345678 aes
Warning: The current password is too simple. For the sake of security, you are a
dvised to set a password containing at least two of the following: lowercase let
ters a to z, uppercase letters A to Z, digits, and special characters. Continue?
 [Y/N]:y
[AC6005-wlan-sec-prof-wlan-net]q
//创建名为&#34;wlan-net&#34;的SSID，并配置SSID名称为&#34;wlan-net&#34;
[AC6005-wlan-view]ssid-profile name wlan-net
[AC6005-wlan-ssid-prof-wlan-net]ssid wlan-net
Info: This operation may take a few seconds, please wait.done.
[AC6005-wlan-ssid-prof-wlan-net]q
//创建名为&#34;wlan-net&#34;的VAP模板，配置业务数据转发模式，业务VLAN，并且引用安全模板和SSID
[AC6005-wlan-view]vap-profile name wlan-net
//配置直接转发
[AC6005-wlan-vap-prof-wlan-net]forward-mode direct-forward 
[AC6005-wlan-vap-prof-wlan-net]security-profile wlan-net
Info: This operation may take a few seconds, please wait.done.
[AC6005-wlan-vap-prof-wlan-net]ssid-profile wlan-net
Info: This operation may take a few seconds, please wait.done.
[AC6005-wlan-vap-prof-wlan-net]q
//配置AP组引用VAP模板，AP上射频1和射频1都使用VAP模板&#34;wlan-net&#34;的配置
[AC6005-wlan-view]ap-group name ap-group1
[AC6005-wlan-ap-group-ap-group1]vap-profile wlan-net wlan 1 radio 0
[AC6005-wlan-ap-group-ap-group1]vap-profile wlan-net wlan 1 radio 1
[AC6005-wlan-ap-group-ap-group1]q
//配置AP射频的信道和功率，关闭射频的信道和功率自动调优功能。射频的信道和功率自动调优功能默认开启，如果不关闭此功能则会导致手动配置不生效
[AC6005-wlan-view]rrm-profile name default
[AC6005-wlan-rrm-prof-default]calibrate auto-channel-select disable 
[AC6005-wlan-rrm-prof-default]calibrate auto-txpower-select disable 
[AC6005-wlan-rrm-prof-default]q
//配置射频0的信道和功率
[AC6005-wlan-view]ap-id 0
[AC6005-wlan-ap-0]radio 0
[AC6005-wlan-radio-0/0]channel 20mhz 6
Warning: This action may cause service interruption. Continue?[Y/N]y
[AC6005-wlan-radio-0/0]eirp 127
Info: The EIRP value takes effect only when automatic transmit power selection i
s disabled, and the value depends on the AP specifications and local laws and re
gulations.
[AC6005-wlan-radio-0/0]q
//配置射频1的信道和功率
[AC6005-wlan-ap-0]radio 1
[AC6005-wlan-radio-0/1]channel 20mhz 149
Warning: This action may cause service interruption. Continue?[Y/N]y
[AC6005-wlan-radio-0/1]eirp 127
</code></pre></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-03-23</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/network/">network</a>,&nbsp;<a href="/tags/ap/">ap</a>,&nbsp;<a href="/tags/ac/">ac</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2024-03-24-route-switch-base/" class="prev" rel="prev" title="Route&amp;Swich 基础"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Route&Swich 基础</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">serialt</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":80},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
