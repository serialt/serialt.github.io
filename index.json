[{"categories":["åŒæ­¥ocié•œåƒ"],"content":"é•œåƒåŒæ­¥ å‚è€ƒé“¾æ¥ï¼š https://lework.github.io/2020/04/13/skopeo/ https://blog.k8s.li/skopeo.html æ—¥å¸¸å·¥ä½œä¸­ï¼Œéœ€è¦å°†å„ç§é•œåƒæ¬åˆ°å¯¹åº”çš„ä»“åº“ä¸­ï¼Œdocker é€‚åˆäºæ„å»ºé•œåƒï¼Œå°†é•œåƒæ¨é€äºä»“åº“ä¸­ã€‚é•œåƒè¢«æ¨é€åˆ°ä»“åº“ä¸­åï¼Œå¦‚æœéœ€è¦å¯¹é•œåƒè¿›è¡Œæ¬è¿ï¼Œåœ¨ä»“åº“ä¸æä¾›è¿™ä¸ªåŠŸèƒ½çš„æƒ…å†µä¸‹ï¼ŒåŒæ­¥é•œåƒæ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚ skopeo æ˜¯çº¢å¸½å¼€æºçš„å®¹å™¨é•œåƒç®¡ç†å·¥å…·ã€‚ç›¸æ¯”äºdockerï¼Œå®ƒæœ‰ä¸€ä¸‹çš„ä¼˜ç‚¹ï¼š æ”¯æŒå¤šä¸ªå¹³å°ï¼šskopeo æ”¯æŒ Linuxï¼ŒMac å’Œ Windowsã€‚ æ— éœ€ docker æˆ–è€… podmanï¼šskopeo å¯ä»¥æ„å»ºä¸ºå•ä¸€çš„ cliï¼Œä¸ä¾èµ–äº docker æœåŠ¡æˆ–è€… podmanã€‚ æ”¯æŒå¤šä¸ª OCI é•œåƒä»“åº“é—´åŒæ­¥ï¼šæ”¯æŒ OCI çš„é•œåƒæ‰˜ç®¡æœåŠ¡ï¼Œéƒ½å¯ä»¥ç›¸äº’åŒæ­¥ã€‚ æ”¯æŒå¤šæ¶æ„é•œåƒåŒæ­¥ï¼šå¯ä»¥åŒæ­¥å¤šç§æ¶æ„çš„é•œåƒã€‚ é•œåƒéªŒç­¾ï¼šskopeo æ”¯æŒé•œåƒç­¾åï¼Œå¯ç¡®ä¿é•œåƒçš„å®Œæ•´æ€§å’Œå¯é æ€§ã€‚ ","date":"2023-11-08","objectID":"/posts/skopeo/:0:0","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"ä¸€ã€ç¼–è¯‘skopeo skopeo å®˜æ–¹å¹¶ä¸æä¾›ç¼–è¯‘å¥½çš„é™æ€äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¸¸è§çš„ç³»ç»Ÿæºä¸­å·²ç»åŒ…å«äº† skopeoï¼Œä½†ç”±äº skopeo çš„ç‰ˆæœ¬è¿­ä»£æ¯”è¾ƒå¿«ï¼Œæ–°çš„åŠŸèƒ½ä¹Ÿéšä¹‹å¢åŠ ï¼Œéƒ¨åˆ†æ“ä½œç³»ç»Ÿé‡Œæä¾›çš„å®‰è£…åŒ…ç‰ˆæœ¬å¯èƒ½æ¯”è¾ƒä½ï¼Œæ— æ³•é€‚ç”¨ï¼Œä¸” skopeo å¤§å¤šéƒ½æ˜¯é“¾æ¥äº†åŠ¨æ€åº“ï¼Œæ— æ³•é€šç”¨äºå¤šä¸ª linux å‘è¡Œç‰ˆï¼Œå› æ­¤å¯ä»¥å€ŸåŠ©dockerå®ç°skopeoçš„é™æ€ç¼–è¯‘ã€‚ åŸºäºgithub actionæ„å»ºskopeo: skopeo ","date":"2023-11-08","objectID":"/posts/skopeo/:1:0","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"ä¸‹è½½ skopeo æºç  # download source code git clone --depth=1 https://github.com/containers/skopeo.git ","date":"2023-11-08","objectID":"/posts/skopeo/:1:1","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"æ„å»ºbuildé•œåƒçš„Dockerfile å›½å†…æ„å»ºåˆ™éœ€è¦ä¿®æ”¹ alpine å’Œ go é•œåƒåœ°å€ï¼Œå¯ç›´è¿ github çš„å¯ä»¥å¿½ç•¥æ­¤æ­¥ FROM golang:1.19-alpine3.16 AS builder ENV LANG=C.UTF-8 ENV TZ=Asia/Shanghai ENV CGO_ENABLED=0 ENV GOPROXY=https://goproxy.cn,direct RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories RUN apk update --no-cache \u0026\u0026 apk add --no-cache ca-certificates ","date":"2023-11-08","objectID":"/posts/skopeo/:1:2","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"æ„å»º build é•œåƒ docker build -t skopeo-build . ","date":"2023-11-08","objectID":"/posts/skopeo/:1:3","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"æ„å»º skopeo é™æ€äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ cd skopeo/ # æ„å»º linux amd64 æ¶æ„ docker run --rm -t -v $PWD:/build skopeo-build sh -c \"apk update \u0026\u0026 apk add gpgme btrfs-progs-dev llvm13-dev gcc musl-dev \u0026\u0026 cd /build \u0026\u0026 CGO_ENABLE=0 GO111MODULE=on GOOS=linux GOARCH=amd64 go build -mod=vendor '-buildmode=pie' -ldflags '-extldflags -static' -gcflags '' -tags 'exclude_graphdriver_devicemapper exclude_graphdriver_btrfs containers_image_openpgp' -o ./bin/skopeo-linux-amd64 ./cmd/skopeo \" # æ„å»º linux arm64 æ¶æ„ docker run --rm -t -v $PWD:/build skopeo-build sh -c \"apk update \u0026\u0026 apk add gpgme btrfs-progs-dev llvm13-dev gcc musl-dev \u0026\u0026 cd /build \u0026\u0026 CGO_ENABLE=0 GO111MODULE=on GOOS=linux GOARCH=arm64 go build -mod=vendor '-buildmode=pie' -ldflags '-extldflags -static' -gcflags '' -tags 'exclude_graphdriver_devicemapper exclude_graphdriver_btrfs containers_image_openpgp' -o ./bin/skopeo-linux-arm64 ./cmd/skopeo \" ","date":"2023-11-08","objectID":"/posts/skopeo/:1:4","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"äºŒã€skopeo å‘½ä»¤ä½¿ç”¨ [root@tc ~]# skopeo -v skopeo version 1.11.1-dev [root@tc ~]# skopeo --help Various operations with container images and container image registries Usage: skopeo [flags] skopeo [command] Available Commands: copy Copy an IMAGE-NAME from one location to another delete Delete image IMAGE-NAME generate-sigstore-key Generate a sigstore public/private key pair help Help about any command inspect Inspect image IMAGE-NAME list-tags List tags in the transport/repository specified by the SOURCE-IMAGE login Login to a container registry logout Logout of a container registry manifest-digest Compute a manifest digest of a file standalone-sign Create a signature using local files standalone-verify Verify a signature using local files sync Synchronize one or more images from one location to another Flags: --command-timeout duration timeout for the command execution --debug enable debug output -h, --help help for skopeo --insecure-policy run the tool without any policy check --override-arch ARCH use ARCH instead of the architecture of the machine for choosing images --override-os OS use OS instead of the running OS for choosing images --override-variant VARIANT use VARIANT instead of the running architecture variant for choosing images --policy string Path to a trust policy file --registries.d DIR use registry configuration files in DIR (e.g. for container signature storage) --tmpdir string directory used to store temporary files -v, --version Version for Skopeo Use \"skopeo [command] --help\" for more information about a command. # ç™»å½•ä¸ç™»å‡º oci skopeo login -u username docker.io skopeo logout docker.io ä¸ä¸‹è½½é•œåƒæƒ…å†µä¸‹è·å–é•œåƒä¿¡æ¯ [root@tc ~]# skopeo inspect docker://docker.io/alpine { \"Name\": \"docker.io/library/alpine\", \"Digest\": \"sha256:eece025e432126ce23f223450a0326fbebde39cdf496a85d8c016293fc851978\", \"RepoTags\": [ \"20220316\", \"20220328\", \"20220715\", \"20221110\", \"20230208\", \"20230329\", \"20230901\", \"3\", \"3.17\", \"3.17.0\", \"3.17.0_rc1\", \"3.17.1\", \"3.17.2\", \"3.17.3\", \"3.17.4\", \"3.17.5\", \"3.18\", \"3.18.0\", \"3.18.2\", \"3.18.3\", \"3.18.4\", \"edge\", \"latest\" ], \"Created\": \"2023-09-28T21:19:27.801479409Z\", \"DockerVersion\": \"20.10.23\", \"Labels\": null, \"Architecture\": \"amd64\", \"Os\": \"linux\", \"Layers\": [ \"sha256:96526aa774ef0126ad0fe9e9a95764c5fc37f409ab9e97021e7b4775d82bf6fa\" ], \"LayersData\": [ { \"MIMEType\": \"application/vnd.docker.image.rootfs.diff.tar.gzip\", \"Digest\": \"sha256:96526aa774ef0126ad0fe9e9a95764c5fc37f409ab9e97021e7b4775d82bf6fa\", \"Size\": 3401967, \"Annotations\": null } ], \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ] } docker://: æ˜¯ä½¿ç”¨ Docker Registry HTTP API V2 è¿›è¡Œè¿æ¥è¿œç«¯ docker.io: è¿œç¨‹ä»“åº“ alpine: é•œåƒåç§° è·å–æœ¬åœ°é•œåƒä¿¡æ¯ [root@tc ~]# skopeo inspect docker-daemon:alpine:3 { \"Name\": \"docker.io/library/alpine\", \"Digest\": \"sha256:844bc35fdf7a96e5b6bf5e76e20989a797cc75976fad73275061a36f448b92b9\", \"RepoTags\": [], \"Created\": \"2023-09-28T21:19:27.801479409Z\", \"DockerVersion\": \"20.10.23\", \"Labels\": null, \"Architecture\": \"amd64\", \"Os\": \"linux\", \"Layers\": [ \"sha256:cc2447e1835a40530975ab80bb1f872fbab0f2a0faecf2ab16fbbb89b3589438\" ], \"LayersData\": [ { \"MIMEType\": \"application/vnd.docker.image.rootfs.diff.tar.gzip\", \"Digest\": \"sha256:cc2447e1835a40530975ab80bb1f872fbab0f2a0faecf2ab16fbbb89b3589438\", \"Size\": 7625728, \"Annotations\": null } ], \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ] } docker-daemon: dockerå®ˆæŠ¤é•œåƒçš„é•œåƒ alpine:3: æœ¬åœ°é•œåƒçš„åç§° ","date":"2023-11-08","objectID":"/posts/skopeo/:2:0","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"copyé•œåƒ # skopeo --insecure-policy copy docker://nginx:1.17.6 docker-archive:/tmp/nginx.tar Getting image source signatures Copying blob 8ec398bc0356 done Copying blob 465560073b6f done Copying blob f473f9fd0a8c done Copying config f7bb5701a3 done Writing manifest to image destination Storing signatures # ls -alh /tmp/nginx.tar -rw-r--r-- 1 root root 125M 4æœˆ 13 15:22 /tmp/nginx.tar --insecure-policy: ç”¨äºå¿½ç•¥å®‰å…¨ç­–ç•¥é…ç½®æ–‡ä»¶ docker://nginx:1.17.6: è¯¥å‘½ä»¤å°†ä¼šç›´æ¥é€šè¿‡ http ä¸‹è½½ç›®æ ‡é•œåƒ docker-archive: å­˜å‚¨ä¸º /tmp/nginx.tarï¼Œæ­¤æ–‡ä»¶å¯ä»¥ç›´æ¥é€šè¿‡ docker load å‘½ä»¤å¯¼å…¥ ç›¸åº”çš„ï¼Œå¯ä»¥å°†ä¸‹è½½çš„æ–‡ä»¶å¯¼å…¥åˆ°æœ¬åœ° # skopeo copy docker-archive:/tmp/nginx.tar docker-daemon:nginx:latest Getting image source signatures Copying blob 556c5fb0d91b done Copying blob 49434cc20e95 done Copying blob 75248c0d5438 done Copying config f7bb5701a3 done Writing manifest to image destination Storing signatures # docker images nginx REPOSITORY TAG IMAGE ID CREATED SIZE nginx latest f7bb5701a33c 3 months ago 126MB COPY # ä¹Ÿå¯ä»¥å°†é•œåƒä¸‹è½½åˆ°æŒ‡å®šç›®å½• # skopeo copy docker://busybox:latest dir:/tmp/busybox Getting image source signatures Copying blob 0669b0daf1fb done Copying config 83aa35aa1c done Writing manifest to image destination Storing signatures # ls -alh /tmp/busybox/ æ€»ç”¨é‡ 760K drwxr-xr-x 2 root root 186 4æœˆ 13 15:26 . drwxrwxrwt. 12 root root 4.0K 4æœˆ 13 15:25 .. -rw-r--r-- 1 root root 743K 4æœˆ 13 15:26 0669b0daf1fba90642d105f3bc2c94365c5282155a33cc65ac946347a90d90d1 -rw-r--r-- 1 root root 1.5K 4æœˆ 13 15:26 83aa35aa1c79e4b6957e018da6e322bfca92bf3b4696a211b42502543c242d6f -rw-r--r-- 1 root root 527 4æœˆ 13 15:26 manifest.json -rw-r--r-- 1 root root 33 4æœˆ 13 15:25 version #æˆ–è€…ä»æŒ‡å®šç›®å½•å¯¼å…¥åˆ°æœ¬åœ° # skopeo copy dir:/tmp/busybox docker-daemon:busybox:latest Getting image source signatures Copying blob 0669b0daf1fb done Copying config 83aa35aa1c done Writing manifest to image destination Storing signatures # docker images busybox REPOSITORY TAG IMAGE ID CREATED SIZE busybox latest 83aa35aa1c79 4 weeks ago 1.22MB ","date":"2023-11-08","objectID":"/posts/skopeo/:2:1","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"åˆ é™¤é•œåƒ skopeo delete docker://localhost:5000/nginx:latest ","date":"2023-11-08","objectID":"/posts/skopeo/:2:2","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"è®¤è¯æ–‡ä»¶ è®¤è¯æ–‡ä»¶é»˜è®¤å­˜æ”¾åœ¨ $HOME/.docker/config.json æ–‡ä»¶å†…å®¹ { \"auths\": { \"myregistrydomain.com:5000\": { \"auth\": \"dGVzdHVzZXI6dGVzdHxxxxxxxx\", \"email\": \"cc@local.com\" } } } ","date":"2023-11-08","objectID":"/posts/skopeo/:2:3","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"sync åœ¨ OCI é—´åŒæ­¥é•œåƒ ä½¿ç”¨ docke råœ¨ OCI é—´åŒæ­¥é•œåƒçš„æ—¶å€™ï¼Œéœ€è¦å…ˆæŠŠé•œåƒæ‹‰ä¸‹æ¥ï¼Œæ‰“ä¸Š tag ï¼Œç„¶ååœ¨æ¨é€åˆ°ç›®çš„ OCI ä¸Šã€‚åœ¨è¿™ä¸ªæ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œå³å ç”¨äº†å­˜å‚¨ï¼Œåˆå ç”¨äº†å¸¦å®½ï¼Œåœ¨åŒæ­¥å¤§çš„é•œåƒæˆ–è€…å¤§é‡çš„é•œåƒçš„æ—¶å€™ï¼Œå­˜å‚¨ä¼šä¸¥é‡å½±å“é•œåƒåœ¨ OCI é—´åŒæ­¥çš„æ•ˆç‡ã€‚skopeo æ­£å¥½å¯ä»¥è§£å†³è¿™ä¸ªç¼ºç‚¹ï¼Œskopeo åœ¨åŒæ­¥ OCI é•œåƒçš„è¿‡ç¨‹ä¸­ï¼Œåªå ç”¨å¸¦å®½ï¼Œä¸ä¼šæŠŠé•œåƒä¸‹è½½åˆ°æœ¬åœ°ã€‚ åŸºäº yaml æ–‡ä»¶çš„åŒæ­¥ # sync.yaml ghcr.io: images: kube-vip/kube-vip: - 'v0.6.0' - 'v0.4.4' k3d-io/k3d-tools: - '5.5.2' åŒæ­¥é•œåƒ skopeo --insecure-policy sync -a --src yaml --dest docker sync.yaml repo.local.com/serialt ","date":"2023-11-08","objectID":"/posts/skopeo/:2:4","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"ä¸‰ã€åŒæ­¥é•œåƒ ç›®å‰ï¼Œå¸¸ç”¨çš„ OCI ä»“åº“æœ‰ï¼šdocker.ioï¼Œquay.ioï¼Œgcr.ioï¼Œregistry.k8s.ioï¼Œghcr.io ç­‰ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œå› ä¸ºæŸäº›åŸå› ï¼Œè¿™äº› OCI ä»“åº“åœ¨å›½å†…æ— æ³•è®¿é—®ï¼Œè€Œä¸€äº›é¡¹ç›®åˆä¸¥é‡ä¾èµ–äºå­˜å‚¨åœ¨è¿™äº› OCI ä»“åº“çš„é•œåƒï¼Œè™½ç„¶æœ‰çƒ­å¿ƒçš„å¤§ä½¬ä»¬ä¼šæŠŠ gcr å’Œ ghcr ä¸Šå­˜å‚¨çš„é•œåƒåŒæ­¥åˆ° docker hub ä¸­ï¼Œä½†å› ä¸ºè¿™äº›è¢«æ¨é€åˆ° docker hub ä¸­çš„é•œåƒä¸æ˜¯å®˜æ–¹ç»´æŠ¤çš„ï¼Œå¯èƒ½ä¼šå­˜åœ¨æ¯”è¾ƒå¤§çš„é•œåƒçš„åŒæ­¥æ—¶é—´å·®ï¼ŒæŸäº›éœ€è¦çš„é•œåƒæ— æ³•åœ¨ docker hub ä¸Šæ‰¾åˆ°ï¼ŒåŒæ—¶ä¹Ÿå®¹æ˜“å¼•èµ·å®¹å™¨é•œåƒçš„ä¾›åº”é“¾å®‰å…¨é—®é¢˜ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨ github action ä½¿ç”¨ skopeo è¿›è¡ŒåŒæ­¥é•œåƒã€‚ é¡¹ç›®åœ°å€ï¼šsync-image ","date":"2023-11-08","objectID":"/posts/skopeo/:3:0","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"1ã€å®‰è£…sync-image å’Œ skopeo wget https://github.com/serialt/skopeo/releases/download/v1.13.3/skopeo-linux-amd64 go install github.com/serialt/sync-image@latest ","date":"2023-11-08","objectID":"/posts/skopeo/:3:1","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"2ã€é…ç½®sync-image yaml é…ç½®æ–‡ä»¶ # config.yaml # é•œåƒåŒæ­¥çš„ä¸ªæ•° last: 10 # mcråŒæ­¥çš„ä¸ªæ•°ï¼Œmcrä¸­åŒ…å«å¤šä¸ª vscode å®¹å™¨å¼€å‘çš„é•œåƒ mcrLast: 50 autoSyncfile: sync.yaml # ä¸åŒæ­¥å¸¦æœ‰ä»¥ä¸‹å…³é”®å­—çš„é•œåƒçš„tag exclude: - 'alpha' - 'beta' - 'rc' - 'amd64' - 'ppc64le' - 'arm64' - 'arm' - 's390x' - 'SNAPSHOT' - 'snapshot' - 'debug' - 'master' - 'latest' - 'main' - 'sig' - 'sha' - 'mips' # éœ€è¦åŒæ­¥çš„é•œåƒ images: docker.elastic.co: - elasticsearch/elasticsearch - kibana/kibana - logstash/logstash - beats/filebeat - beats/heartbeat - beats/packetbeat - beats/auditbeat - beats/journalbeat - beats/metricbeat - apm/apm-server - app-search/app-search quay.io: - coreos/flannel - ceph/ceph - cephcsi/cephcsi - csiaddons/k8s-sidecar - csiaddons/volumereplication-operator - prometheus/prometheus - prometheus/alertmanager - prometheus/pushgateway - prometheus/blackbox-exporter - prometheus/node-exporter - prometheus-operator/prometheus-config-reloader - prometheus-operator/prometheus-operator - brancz/kube-rbac-proxy - jetstack/cert-manager-webhook - jetstack/cert-manager-controller - jetstack/cert-manager-cainjector k8s.gcr.io: - conformance - dns/k8s-dns-node-cache - metrics-server/metrics-server - kube-state-metrics/kube-state-metrics - prometheus-adapter/prometheus-adapter registry.k8s.io: - sig-storage/local-volume-provisioner - metrics-server/metrics-server - defaultbackend - ingress-nginx/controller - ingress-nginx/kube-webhook-certgen - sig-storage/nfs-subdir-external-provisioner - sig-storage/csi-node-driver-registrar - sig-storage/csi-provisioner - sig-storage/csi-resizer - sig-storage/csi-snapshotter - sig-storage/snapshot-controller - sig-storage/snapshot-validation-webhook - sig-storage/nfsplugin - sig-storage/csi-attacher - sig-storage/livenessprobe - defaultbackend-amd64 - defaultbackend-arm64 - pause - etcd - kube-proxy - kube-apiserver - kube-scheduler - kube-controller-manager - coredns/coredns - build-image/kube-cross gcr.io: - kaniko-project/executor ghcr.io: - k3d-io/k3d-tools - k3d-io/k3d-proxy - kube-vip/kube-vip mcr.microsoft.com: - devcontainers/base - devcontainers/go docker.io: - flannel/flannel - flannel/flannel-cni-plugin - calico/kube-controllers - serialt/rocky - serialt/alma - calico/cni - calico/pod2daemon-flexvol - calico/kube-controllers - calico/node - rancher/mirrored-flannelcni-flannel-cni-plugin - rancher/mirrored-flannelcni-flanne ","date":"2023-11-08","objectID":"/posts/skopeo/:3:2","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"3ã€ç”ŸæˆåŠ¨æ€åŒæ­¥çš„ yaml æ–‡ä»¶ sync-image -c config.yaml ","date":"2023-11-08","objectID":"/posts/skopeo/:3:3","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"4ã€åŒæ­¥é•œåƒ ä¾èµ–çš„ç¯å¢ƒå˜é‡ DEST_HUB_USERNAME DEST_HUB_PASSWORD MY_GITHUB_TOKEN åŒæ­¥çš„shellè„šæœ¬ hub=\"docker.io\" repo=\"$hub/${DEST_HUB_USERNAME}\" hub2=\"registry.cn-hangzhou.aliyuncs.com\" repo2=\"$hub2/${DEST_HUB_USERNAME}\" if [ -f sync.yaml ]; then echo \"[Start] sync.......\" sudo skopeo login -u ${DEST_HUB_USERNAME} -p ${DEST_HUB_PASSWORD} ${hub} \\ \u0026\u0026 sudo skopeo --insecure-policy sync -a --src yaml --dest docker sync.yaml ${repo} \\ \u0026\u0026 sudo skopeo --insecure-policy sync -a --src yaml --dest docker custom_sync.yaml ${repo} sleep 3 sudo skopeo login -u ${DEST_HUB_USERNAME} -p ${DEST_HUB_PASSWORD} ${hub2} \\ \u0026\u0026 sudo skopeo --insecure-policy sync -a --src yaml --dest docker sync.yaml ${repo2} \\ \u0026\u0026 sudo skopeo --insecure-policy sync -a --src yaml --dest docker custom_sync.yaml ${repo2} echo \"[End] done.\" else echo \"[Error]not found sync.yaml!\" fi ","date":"2023-11-08","objectID":"/posts/skopeo/:3:4","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["åŒæ­¥ocié•œåƒ"],"content":"5ã€github action é…ç½®æ–‡ä»¶ name: sync on: push: branches: - master - main schedule: - cron: \"0 2 * * *\" # Allows you to run this workflow manually from the Actions tab workflow_dispatch: jobs: sync: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Set up Go uses: actions/setup-go@v4 with: go-version: '\u003e=1.21.0' - name: Install dependencies run: | export version=v1.10.0 \u0026\u0026 export arch=amd64 \u0026\u0026 sudo wget https://github.com/lework/skopeo-binary/releases/download/${version}/skopeo-linux-${arch} -O /usr/bin/skopeo \u0026\u0026 sudo chmod +x /usr/bin/skopeo skopeo --version go install github.com/serialt/sync-image@latest - name: generate_sync_yaml env: SRC_HUB_USERNAME: ${{ secrets.SRC_HUB_USERNAME }} DEST_HUB_USERNAME: ${{ secrets.DEST_HUB_USERNAME }} DEST_HUB_PASSWORD: ${{ secrets.DEST_HUB_PASSWORD }} MY_GITHUB_TOKEN: ${{ secrets.MY_GITHUB_TOKEN }} timeout-minutes: 10 run: | sync-image - name: sync image env: SRC_HUB_USERNAME: ${{ secrets.SRC_HUB_USERNAME }} DEST_HUB_USERNAME: ${{ secrets.DEST_HUB_USERNAME }} DEST_HUB_PASSWORD: ${{ secrets.DEST_HUB_PASSWORD }} run: | bash sync.sh ","date":"2023-11-08","objectID":"/posts/skopeo/:3:5","tags":["skopeo","image","oci-image-sync"],"title":"Skopeo","uri":"/posts/skopeo/"},{"categories":["morseç¼–ç "],"content":"Morse Code äºŒå‰æ ‘è®°å¿†æ³• start E T I A N M S U R W D K G O H V F L P J B X C Y Z Q . - E T .. .- -. -- I A N M ... ..- .-. ..- -.. -.- --. --- S U R W D K G O .... ...- ..-. .-.. .--. .--- -... -..- -.-. -.-- --.. --.- H v F L P J B X C Y Z Q ","date":"2023-11-08","objectID":"/posts/morse-code/:1:0","tags":["morse","morse-code"],"title":"Morse Code","uri":"/posts/morse-code/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"æ“ä½œç³»ç»Ÿæˆ–è€…è½¯ä»¶æ¢æºåŠ é€Ÿ ","date":"2023-11-07","objectID":"/posts/mirror-cn/:0:0","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"1ã€æ“ä½œç³»ç»Ÿ ","date":"2023-11-07","objectID":"/posts/mirror-cn/:1:0","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"rocky # 8 base sed -e 's|^mirrorlist=|#mirrorlist=|g' \\ -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.ustc.edu.cn/rocky|g' \\ -i.bak /etc/yum.repos.d/Rocky*.repo # 8 epel sed -e 's|^metalink=|#metalink=|g' \\ -e 's|^#baseurl=https\\?://download.fedoraproject.org/pub/epel/|baseurl=https://mirrors.ustc.edu.cn/epel/|g' \\ -e 's|^#baseurl=https\\?://download.example/pub/epel/|baseurl=https://mirrors.ustc.edu.cn/epel/|g' \\ -i.bak /etc/yum.repos.d/epel*.repo # 9 base sed -e 's|^mirrorlist=|#mirrorlist=|g' \\ -e 's|^#baseurl=http://dl.rockylinux.org/$contentdir|baseurl=https://mirrors.ustc.edu.cn/rocky|g' \\ -i.bak /etc/yum.repos.d/rocky*.repo # 9 epel sed -e 's|^metalink=|#metalink=|g' \\ -e 's|^#baseurl=https\\?://download.fedoraproject.org/pub/epel/|baseurl=https://mirrors.ustc.edu.cn/epel/|g' \\ -e 's|^#baseurl=https\\?://download.example/pub/epel/|baseurl=https://mirrors.ustc.edu.cn/epel/|g' \\ -i.bak /etc/yum.repos.d/epel*.repo ","date":"2023-11-07","objectID":"/posts/mirror-cn/:1:1","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"ubuntu # http sed -e \"s@http://.*archive.ubuntu.com@http://mirrors.aliyun.com@g\" \\ -e \"s@http://.*security.ubuntu.com@http://mirrors.aliyun.com@g\" \\ -i.bak -i /etc/apt/sources.list # https sed -e \"s@http://.*archive.ubuntu.com@https://mirrors.aliyun.com@g\" \\ -e \"s@http://.*security.ubuntu.com@https://mirrors.aliyun.com@g\" \\ -i.bak -i /etc/apt/sources.list ","date":"2023-11-07","objectID":"/posts/mirror-cn/:1:2","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"debian # debian 12åŠä»¥ä¸Š sed -i 's/\\w*.debian.org/mirrors.ustc.edu.cn/g' /etc/apt/sources.list.d/debian.sources sed -i \"s@http://mirrors.ustc.edu.cn@https://mirrors.ustc.edu.cn@g\" /etc/apt/sources.list.d/debian.sources # debian 12ä»¥ä¸‹ sed -i 's/\\w*.debian.org/mirrors.ustc.edu.cn/g' /etc/apt/sources.list sed -i \"s@http://mirrors.ustc.edu.cn@https://mirrors.ustc.edu.cn@g\" /etc/apt/sources.list ","date":"2023-11-07","objectID":"/posts/mirror-cn/:1:3","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"alpine # alpine å®˜æ–¹æº https://dl-cdn.alpinelinux.org/alpine/v3.18/main https://dl-cdn.alpinelinux.org/alpine/v3.18/community # ustc sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories # edge æº echo \"https://mirrors.ustc.edu.cn/alpine/edge/main\" \u003e\u003e /etc/apk/repositories echo \"https://mirrors.ustc.edu.cn/alpine/edge/community\" \u003e\u003e /etc/apk/repositories echo \"https://mirrors.ustc.edu.cn/alpine/edge/testing\" \u003e\u003e /etc/apk/repositories ","date":"2023-11-07","objectID":"/posts/mirror-cn/:1:4","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"2ã€å¼€å‘è¯­è¨€ç±» go export GOPROXY=https://goproxy.cn,direct # aliyun export GOPROXY=https://mirrors.aliyun.com/goproxy/ python export PIP_MIRROR=mirrors.aliyun.com echo -e \"[global]\\nindex-url=https://${PIP_MIRROR}/pypi/simple\\n[install]\\ntrusted-host=${PIP_MIRROR}\" \u003e /etc/pip.conf # å‘½ä»¤é…ç½® pip3 install xxx -i https://mirrors.aliyun.com/pypi/simple/ npm # è®¾ç½®å…¨å±€ npm config set registry https://registry.npmmirror.com # cmd npm install -y --registry=https://registry.npmmirror.com # å®˜æ–¹åœ°å€ https://registry.npmjs.org/ # é˜¿é‡Œäº‘åœ°å€ https://registry.npmmirror.com # è…¾è®¯ http://mirrors.cloud.tencent.com/npm/ # åä¸º https://repo.huaweicloud.com/repository/npm/ # å—äº¬å¤§å­¦ https://repo.nju.edu.cn/repository/npm/ ","date":"2023-11-07","objectID":"/posts/mirror-cn/:2:0","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["ç³»ç»Ÿæˆ–è½¯ä»¶æ¢æº"],"content":"3ã€å®¹å™¨ä»£ç† é…ç½®æ¨¡ç‰ˆ { \"insecure-registries\": [ \"repo.local.com\" ], \"exec-opts\": [ \"native.cgroupdriver=systemd\" ], \"registry-mirrors\": [ \"https://docker.mirrors.sjtug.sjtu.edu.cn\", \"https://docker.nju.edu.cn\", \"http://hub-mirror.c.163.com\" ], \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\", \"max-file\": \"3\" }, \"bip\":\"192.161.20.1/24\", \"dns\": [ \"119.29.29.29\", \"223.5.5.5\" ], \"data-root\": \"/var/lib/docker\", \"features\": { \"buildkit\": true } } docker registry # ä¸Šæµ·äº¤å¤§ https://docker.mirrors.sjtug.sjtu.edu.cn # å—äº¬å¤§å­¦ https://docker.nju.edu.cn # dockerproxy https://dockerproxy.com gcr.io # ä¸Šæµ·äº¤å¤§ https://gcr-io.mirrors.sjtug.sjtu.edu.cn # å—äº¬å¤§å­¦ https://gcr.nju.edu.cn # dockerproxy https://gcr.dockerproxy.com ghcr.io # å—äº¬å¤§å­¦ https://htghcr.nju.edu.cn # dockerproxy https://ghcr.dockerproxy.com nvcr.io # å—äº¬å¤§å­¦ https://nvcr.nju.edu.cn quay.io # å—äº¬å¤§å­¦ https://quay.nju.edu.cn # dockerproxy quay.dockerproxy.com registry.k8s.io # å—äº¬å¤§å­¦ k8s.mirror.nju.edu.cn # dockerproxy k8s.dockerproxy.com Microsoft Artifact Registry mcr.dockerproxy.com ","date":"2023-11-07","objectID":"/posts/mirror-cn/:3:0","tags":["mirror","source","mirror-to-cn"],"title":"To-mirror","uri":"/posts/mirror-cn/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"req Goè¯­è¨€äººæ€§åŒ–HTTPè¯·æ±‚åº“ ç‰¹æ€§ è½»é‡çº§ ç®€å• å®¹æ˜“æ“ä½œJSONå’ŒXML å®¹æ˜“è°ƒè¯•å’Œæ—¥å¿—è®°å½• å®¹æ˜“ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ å®¹æ˜“ç®¡ç†Cookie å®¹æ˜“è®¾ç½®ä»£ç† å®¹æ˜“è®¾ç½®è¶…æ—¶ å®¹æ˜“è‡ªå®šä¹‰HTTPå®¢æˆ·ç«¯ å®‰è£… go get github.com/serialt/req æ¦‚è¦ req åŸºäºæ ‡å‡†åº“ net/http å®ç°äº†ä¸€ä¸ªå‹å¥½çš„API. Req å’Œ Resp æ˜¯ä¸¤ä¸ªæœ€é‡è¦çš„ç»“æ„ä½“, ä½ å¯ä»¥æŠŠ Req çœ‹ä½œå®¢æˆ·ç«¯ï¼Œ æŠŠResp çœ‹ä½œå­˜æ”¾è¯·æ±‚åŠå…¶å“åº”çš„å®¹å™¨ï¼Œå®ƒä»¬éƒ½æä¾›è®¸å¤šç®€æ´æ–¹ä¾¿çš„APIï¼Œè®©ä½ å¯ä»¥å¾ˆè½»æ¾åšå¾ˆå¤šå¾ˆå¤šäº‹æƒ…ã€‚ func (r *Req) Post(url string, v ...interface{}) (*Resp, error) å¤§å¤šæƒ…å†µä¸‹ï¼Œå‘èµ·è¯·æ±‚åªæœ‰urlæ˜¯å¿…é€‰å‚æ•°ï¼Œå…¶å®ƒéƒ½å¯é€‰ï¼Œæ¯”å¦‚è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ã€æ–‡ä»¶æˆ–è¯·æ±‚ä½“ç­‰ã€‚ åŒ…ä¸­å«ä¸€ä¸ªé»˜è®¤çš„ Req å¯¹è±¡, å®ƒæ‰€æœ‰çš„å…¬æœ‰æ–¹æ³•éƒ½è¢«reqåŒ…å¯¹åº”çš„å…¬æœ‰æ–¹æ³•åŒ…è£…äº†ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ç›´æ¥å¯ä»¥æŠŠreqåŒ…çœ‹ä½œä¸€ä¸ªReqå¯¹è±¡æ¥ä½¿ç”¨ã€‚ // åˆ›å»ºReqå¯¹è±¡æ¥å‘èµ·è¯·æ±‚ r := req.New() r.Get(url) // ç›´æ¥ä½¿ç”¨reqåŒ…å‘èµ·è¯·æ±‚ req.Get(url) ä½ å¯ä»¥ä½¿ç”¨ req.New() æ–¹æ³•æ¥åˆ›å»º *Req ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å®¢æˆ·ç«¯ ä¾‹å­ åŸºç¡€ç”¨æ³• è®¾ç½®è¯·æ±‚å¤´ è®¾ç½®è¯·æ±‚å‚æ•° è®¾ç½®è¯·æ±‚ä½“ è°ƒè¯• è¾“å‡ºæ ¼å¼ ToJSON \u0026 ToXML è·å– *http.Response ä¸Šä¼  ä¸‹è½½ Cookie è®¾ç½®è¶…æ—¶ è®¾ç½®ä»£ç† è‡ªå®šä¹‰ http.Client ","date":"2023-10-09","objectID":"/posts/req/:0:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"åŸºç¡€ç”¨æ³• header := req.Header{ \"Accept\": \"application/json\", \"Authorization\": \"Basic YWRtaW46YWRtaW4=\", } param := req.Param{ \"name\": \"imroc\", \"cmd\": \"add\", } // åªæœ‰urlå¿…é€‰ï¼Œå…¶å®ƒå‚æ•°éƒ½æ˜¯å¯é€‰ r, err = req.Post(\"http://foo.bar/api\", header, param) if err != nil { log.Fatal(err) } r.ToJSON(\u0026foo) // å“åº”ä½“è½¬æˆå¯¹è±¡ log.Printf(\"%+v\", r) // æ‰“å°è¯¦ç»†ä¿¡æ¯ ","date":"2023-10-09","objectID":"/posts/req/:1:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è®¾ç½®è¯·æ±‚å¤´ ä½¿ç”¨ req.Header (å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª map[string]string) authHeader := req.Header{ \"Accept\": \"application/json\", \"Authorization\": \"Basic YWRtaW46YWRtaW4=\", } req.Get(\"https://www.baidu.com\", authHeader, req.Header{\"User-Agent\": \"V1.1\"}) ä½¿ç”¨ http.Header header := make(http.Header) header.Set(\"Accept\", \"application/json\") req.Get(\"https://www.baidu.com\", header) ä½ å¯ä»¥ä½¿ç”¨ struct æ¥è®¾ç½®è¯·æ±‚å¤´ï¼Œç”¨ HeaderFromStruct è¿™ä¸ªå‡½æ•°æ¥è§£æä½ çš„ struct type HeaderStruct struct { UserAgent string `json:\"User-Agent\"` Authorization string `json:\"Authorization\"` } func main(){ h := HeaderStruct{ \"V1.0.0\", \"roc\", } authHeader := req.HeaderFromStruct(h) req.Get(\"https://www.baidu.com\", authHeader, req.Header{\"User-Agent\": \"V1.1\"}) } æ³¨ï¼šè¯·ç»™ä½ çš„ struct åŠ ä¸Š json tag. ","date":"2023-10-09","objectID":"/posts/req/:2:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è®¾ç½®è¯·æ±‚å‚æ•° Use req.Param (å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª map[string]interface{}) param := req.Param{ \"id\": \"imroc\", \"pwd\": \"roc\", } req.Get(\"http://foo.bar/api\", param) // http://foo.bar/api?id=imroc\u0026pwd=roc req.Post(url, param) // è¯·æ±‚ä½“ =\u003e id=imroc\u0026pwd=roc ä½¿ç”¨ req.QueryParam å¼ºåˆ¶å°†è¯·æ±‚å‚æ•°æ‹¼åœ¨urlåé¢ (å®ƒå®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª map[string]interface{}) req.Post(\"http://foo.bar/api\", req.Param{\"name\": \"roc\", \"age\": \"22\"}, req.QueryParam{\"access_token\": \"fedledGF9Hg9ehTU\"}) /* POST /api?access_token=fedledGF9Hg9ehTU HTTP/1.1 Host: foo.bar User-Agent: Go-http-client/1.1 Content-Length: 15 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 Accept-Encoding: gzip age=22\u0026name=roc */ ","date":"2023-10-09","objectID":"/posts/req/:3:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è®¾ç½®è¯·æ±‚ä½“ Put string, []byte and io.Reader as body directly. req.Post(url, \"id=roc\u0026cmd=query\") å°†å¯¹è±¡ä½œä¸ºJSONæˆ–XMLè¯·æ±‚ä½“ï¼ˆè‡ªåŠ¨æ·»åŠ  Content-Type è¯·æ±‚å¤´ï¼‰ req.Post(url, req.BodyJSON(\u0026foo)) req.Post(url, req.BodyXML(\u0026bar)) ","date":"2023-10-09","objectID":"/posts/req/:4:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è°ƒè¯• å°†å…¨å±€å˜é‡ req.Debug è®¾ç½®ä¸ºtrueï¼Œå°†ä¼šæŠŠæ‰€æœ‰è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ‰“å°åœ¨æ ‡å‡†è¾“å‡ºã€‚ req.Debug = true req.Post(\"http://localhost/test\" \"hi\") ","date":"2023-10-09","objectID":"/posts/req/:5:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è¾“å‡ºæ ¼å¼ æ‚¨å¯ä»¥ä½¿ç”¨æŒ‡å®šç±»å‹çš„è¾“å‡ºæ ¼å¼åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•è¯·æ±‚å’Œå“åº”çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘é˜¶æ®µä½¿ç”¨ï¼…+væ ¼å¼ï¼Œå¯ä»¥è®©ä½ è§‚å¯Ÿè¯·æ±‚å’Œå“åº”çš„ç»†èŠ‚ä¿¡æ¯ã€‚ åœ¨ç”Ÿäº§é˜¶æ®µä½¿ç”¨ï¼…væˆ–ï¼…-vè¾“å‡ºæ ¼å¼ï¼Œåªè®°å½•æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚ ","date":"2023-10-09","objectID":"/posts/req/:6:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"%+v æˆ– %+s è¯¦ç»†è¾“å‡º r, _ := req.Post(url, header, param) log.Printf(\"%+v\", r) // è¾“å‡ºæ ¼å¼å’ŒDebugå¼€å¯æ—¶çš„æ ¼å¼ä¸€æ · ","date":"2023-10-09","objectID":"/posts/req/:6:1","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"%v æˆ– %s ç®€å•è¾“å‡ºï¼ˆé»˜è®¤æ ¼å¼ï¼‰ r, _ := req.Get(url, param) log.Printf(\"%v\\n\", r) // GET http://foo.bar/api?name=roc\u0026cmd=add {\"code\":\"0\",\"msg\":\"success\"} log.Prinln(r) // å’Œä¸Šé¢ä¸€æ · ","date":"2023-10-09","objectID":"/posts/req/:6:2","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"%-v æˆ– %-s ç®€å•è¾“å‡ºå¹¶ä¿æŒæ‰€æœ‰å†…å®¹åœ¨ä¸€è¡Œå†…ï¼ˆè¯·æ±‚ä½“æˆ–å“åº”ä½“å¯èƒ½åŒ…å«å¤šè¡Œï¼Œè¿™ç§æ ¼å¼ä¼šå°†æ‰€æœ‰æ¢è¡Œã€å›è½¦æ›¿æ¢æˆ\" \", è¿™åœ¨ä¼šè®©ä½ åœ¨æŸ¥æ—¥å¿—çš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼‰ ","date":"2023-10-09","objectID":"/posts/req/:6:3","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"Flag ä½ å¯ä»¥è°ƒç”¨ SetFlags æ§åˆ¶è¾“å‡ºå†…å®¹ï¼Œå†³å®šå“ªäº›éƒ¨åˆ†èƒ½å¤Ÿè¢«è¾“å‡ºã€‚ const ( LreqHead = 1 \u003c\u003c iota // è¾“å‡ºè¯·æ±‚é¦–éƒ¨ï¼ˆåŒ…å«è¯·æ±‚è¡Œå’Œè¯·æ±‚å¤´ï¼‰ LreqBody // è¾“å‡ºè¯·æ±‚ä½“ LrespHead // è¾“å‡ºå“åº”é¦–éƒ¨ï¼ˆåŒ…å«å“åº”è¡Œå’Œå“åº”å¤´ï¼‰ LrespBody // è¾“å‡ºå“åº”ä½“ Lcost // è¾“å‡ºè¯·æ±‚æ‰€æ¶ˆè€—æ‰æ—¶é•¿ LstdFlags = LreqHead | LreqBody | LrespHead | LrespBody ) req.SetFlags(req.LreqHead | req.LreqBody | req.LrespHead) ","date":"2023-10-09","objectID":"/posts/req/:6:4","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"ç›‘æ§è¯·æ±‚è€—æ—¶ req.SetFlags(req.LstdFlags | req.Lcost) // è¾“å‡ºæ ¼å¼æ˜¾ç¤ºè¯·æ±‚è€—æ—¶ r,_ := req.Get(url) log.Println(r) // http://foo.bar/api 3.260802ms {\"code\":0 \"msg\":\"success\"} if r.Cost() \u003e 3 * time.Second { // æ£€æŸ¥è€—æ—¶ log.Println(\"WARN: slow request:\", r) } ","date":"2023-10-09","objectID":"/posts/req/:6:5","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"ToJSON \u0026 ToXML r, _ := req.Get(url) r.ToJSON(\u0026foo) r, _ = req.Post(url, req.BodyXML(\u0026bar)) r.ToXML(\u0026baz) ","date":"2023-10-09","objectID":"/posts/req/:7:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è·å– *http.Response // func (r *Req) Response() *http.Response r, _ := req.Get(url) resp := r.Response() fmt.Println(resp.StatusCode) ","date":"2023-10-09","objectID":"/posts/req/:8:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"ä¸Šä¼  ä½¿ç”¨ req.File åŒ¹é…æ–‡ä»¶ req.Post(url, req.File(\"imroc.png\"), req.File(\"/Users/roc/Pictures/*.png\")) ä½¿ç”¨ req.FileUpload ç»†ç²’åº¦æ§åˆ¶ä¸Šä¼  file, _ := os.Open(\"imroc.png\") req.Post(url, req.FileUpload{ File: file, FieldName: \"file\", // FieldName æ˜¯è¡¨å•å­—æ®µå FileName: \"avatar.png\", // Filename æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶çš„åç§°ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥çŒœæµ‹mimetypeï¼Œå¹¶å°†å…¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Š }) ä½¿ç”¨req.UploadProgressç›‘å¬ä¸Šä¼ è¿›åº¦ progress := func(current, total int64) { fmt.Println(float32(current)/float32(total)*100, \"%\") } req.Post(url, req.File(\"/Users/roc/Pictures/*.png\"), req.UploadProgress(progress)) fmt.Println(\"upload complete\") ","date":"2023-10-09","objectID":"/posts/req/:9:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"ä¸‹è½½ r, _ := req.Get(url) r.ToFile(\"imroc.png\") ä½¿ç”¨req.DownloadProgressç›‘å¬ä¸‹è½½è¿›åº¦ progress := func(current, total int64) { fmt.Println(float32(current)/float32(total)*100, \"%\") } r, _ := req.Get(url, req.DownloadProgress(progress)) r.ToFile(\"hello.mp4\") fmt.Println(\"download complete\") ","date":"2023-10-09","objectID":"/posts/req/:10:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"Cookie é»˜è®¤æƒ…å†µä¸‹ï¼Œåº•å±‚çš„ *http.Client ä¼šè‡ªåŠ¨ç®¡ç†ä½ çš„cookieï¼ˆå¦‚æœæœåŠ¡å™¨ç»™ä½ å‘äº†cookieï¼Œä¹‹åçš„è¯·æ±‚å®ƒä¼šè‡ªåŠ¨å¸¦ä¸Šcookieè¯·æ±‚å¤´ç»™æœåŠ¡å™¨ï¼‰, ä½ å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•å–æ¶ˆè‡ªåŠ¨ç®¡ç†ï¼š req.EnableCookie(false) ä½ è¿˜å¯ä»¥åœ¨å‘é€è¯·æ±‚çš„æ—¶å€™è‡ªå·±ä¼ å…¥ *http.Cookie cookie := new(http.Cookie) // ...... req.Get(url, cookie) ","date":"2023-10-09","objectID":"/posts/req/:11:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è®¾ç½®è¶…æ—¶ req.SetTimeout(50 * time.Second) ","date":"2023-10-09","objectID":"/posts/req/:12:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è®¾ç½®ä»£ç† é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç³»ç»Ÿç¯å¢ƒå˜é‡æœ‰ http_proxy æˆ– https_proxy ï¼Œreqä¼šè®²å¯¹åº”çš„åœ°å€ä½œä¸ºå¯¹åº”åè®®çš„ä»£ç†ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è®¾ç½®ä»£ç†ï¼Œæˆ–è€…å°†å…¶ç½®ä¸ºnilï¼Œå³å–æ¶ˆä»£ç†ã€‚ req.SetProxy(func(r *http.Request) (*url.URL, error) { if strings.Contains(r.URL.Hostname(), \"google\") { return url.Parse(\"http://my.vpn.com:23456\") } return nil, nil }) è®¾ç½®ç®€å•ä»£ç†ï¼ˆå°†æ‰€æœ‰è¯·æ±‚éƒ½è½¬å‘åˆ°æŒ‡å®šä»£ç†urlåœ°å€ä¸Šï¼‰ req.SetProxyUrl(\"http://my.proxy.com:23456\") ","date":"2023-10-09","objectID":"/posts/req/:13:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go req åº“æ–‡æ¡£"],"content":"è‡ªå®šä¹‰HTTPå®¢æˆ·ç«¯ ä½¿ç”¨ SetClient æ”¹å˜åº•å±‚çš„ *http.Client req.SetClient(client) ç»™æŸä¸ªè¯·æ±‚åˆ¶å®šç‰¹å®šçš„ *http.Client client := \u0026http.Client{Timeout: 30 * time.Second} req.Get(url, client) æ”¹å˜åº•å±‚ *http.Client çš„æŸäº›å±æ€§ req.Client().Jar, _ = cookiejar.New(nil) trans, _ := req.Client().Transport.(*http.Transport) trans.MaxIdleConns = 20 trans.TLSHandshakeTimeout = 20 * time.Second trans.DisableKeepAlives = true trans.TLSClientConfig = \u0026tls.Config{InsecureSkipVerify: true} ","date":"2023-10-09","objectID":"/posts/req/:14:0","tags":["Go","http","req"],"title":"Go Http Client","uri":"/posts/req/"},{"categories":["Go åº“æ–‡æ¡£"],"content":"Go åŸç”Ÿhttpåº“ Goè¯­è¨€å†…ç½®çš„net/httpåŒ…ååˆ†çš„ä¼˜ç§€ï¼Œæä¾›äº†HTTPå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„å®ç°ã€‚ ","date":"2023-10-09","objectID":"/posts/go-http/:0:0","tags":["Go","http"],"title":"Go Http","uri":"/posts/go-http/"},{"categories":["Go åº“æ–‡æ¡£"],"content":"ä¸€ã€net/httpä»‹ç» Goè¯­è¨€å†…ç½®çš„net/httpåŒ…æä¾›äº†HTTPå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„å®ç°ã€‚ HTTPåè®® è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼ŒHyperText Transfer Protocol)æ˜¯äº’è”ç½‘ä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ä¸€ç§ç½‘ç»œä¼ è¾“åè®®ï¼Œæ‰€æœ‰çš„WWWæ–‡ä»¶éƒ½å¿…é¡»éµå®ˆè¿™ä¸ªæ ‡å‡†ã€‚è®¾è®¡HTTPæœ€åˆçš„ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶HTMLé¡µé¢çš„æ–¹æ³•ã€‚ ","date":"2023-10-09","objectID":"/posts/go-http/:1:0","tags":["Go","http"],"title":"Go Http","uri":"/posts/go-http/"},{"categories":["Go åº“æ–‡æ¡£"],"content":"äºŒã€HTTPå®¢æˆ·ç«¯ Getã€Headã€Postå’ŒPostFormå‡½æ•°å‘å‡ºHTTP/HTTPSè¯·æ±‚ã€‚ resp, err := http.Get(\"http://example.com/\") ... resp, err := http.Post(\"http://example.com/upload\", \"image/jpeg\", \u0026buf) ... resp, err := http.PostForm(\"http://example.com/form\", url.Values{\"key\": {\"Value\"}, \"id\": {\"123\"}}) ç¨‹åºåœ¨ä½¿ç”¨å®Œresponseåå¿…é¡»å…³é—­å›å¤çš„ä¸»ä½“ã€‚ resp, err := http.Get(\"http://example.com/\") if err != nil { // handle error } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) // ... ","date":"2023-10-09","objectID":"/posts/go-http/:2:0","tags":["Go","http"],"title":"Go Http","uri":"/posts/go-http/"},{"categories":["Go åº“æ–‡æ¡£"],"content":"GETè¯·æ±‚ç¤ºä¾‹ package main import ( \"fmt\" \"io\" \"net/http\" ) func main() { resp, err := http.Get(\"https://httpbin.org/uuid\") if err != nil { fmt.Printf(\"get failed, err:%v\\n\", err) return } defer resp.Body.Close() body, err := io.ReadAll(resp.Body) if err != nil { fmt.Printf(\"read from resp.Body failed, err:%v\\n\", err) return } fmt.Print(string(body)) } è‡ªå®šä¹‰è¯·æ±‚ package main import ( \"encoding/json\" \"fmt\" \"io\" \"net/http\" \"net/url\" ) type UUID struct { Uuid string `json:\"uuid\"` } func main() { apiURL := \"https://httpbin.org/uuid\" query := url.Values{} query.Add(\"q\", \"golang\") query.Add(\"page\", \"1\") ApiURL, _ := url.ParseRequestURI(apiURL) ApiURL.RawQuery = query.Encode() req, _ := http.NewRequest(\"GET\", ApiURL.String(), nil) req.Header.Add(\"Accept\", \"*/*\") client := \u0026http.Client{} resp, err := client.Do(req) if err != nil { return } defer resp.Body.Close() var uuid UUID body, err := io.ReadAll(resp.Body) if err != nil { fmt.Printf(\"read from resp.Body failed, err:%v\\n\", err) return } json.Unmarshal(body, \u0026uuid) fmt.Println(uuid.Uuid) } ","date":"2023-10-09","objectID":"/posts/go-http/:2:1","tags":["Go","http"],"title":"Go Http","uri":"/posts/go-http/"},{"categories":["Go åº“æ–‡æ¡£"],"content":"POST è¯·æ±‚ç¤ºä¾‹ package main import ( \"encoding/json\" \"io\" \"net/http\" \"net/url\" ) type dockerToken struct { Token string `json:\"token\"` } func main() { apiUrl := \"https://hub.docker.com/v2/users/login\" data := url.Values{} data.Set(\"username\", \"username\") data.Set(\"password\", \"password\") resp, err := http.PostForm(apiUrl, data) if err != nil { return } defer resp.Body.Close() _data, _ := io.ReadAll(resp.Body) var tmpT dockerToken json.Unmarshal(_data, \u0026tmpT) } package main import ( \"bytes\" \"io\" \"net/http\" \"net/url\" \"strings\" \"log/slog\" ) func POST1() { apiURL := \"https://httpbin.org/post\" form := url.Values{} form.Add(\"ln\", \"ln222\") form.Add(\"ip\", \"1.1.1.1\") form.Add(\"ua\", \"ua123\") client := \u0026http.Client{} req, _ := http.NewRequest(\"POST\", apiURL, strings.NewReader(form.Encode())) req.Header.Set(\"User-Agent\", \"test\") req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\") // å‘é€è¯·æ±‚ resp, err := client.Do(req) if err != nil { slog.Error(\"POST request failed\", \"err\", err) return } defer resp.Body.Close() // è¯»å–å†…å®¹ body, err := io.ReadAll(resp.Body) if err != nil { slog.Error(\"POST request\", \"err\", err) } else { slog.Info(string(body)) } } func POSTJson() { apiURL := \"https://httpbin.org/post\" var jsonStr = []byte(`{\"title\":\"this is a title\", \"cate\": 1}`) client := \u0026http.Client{} req, _ := http.NewRequest(\"POST\", apiURL, bytes.NewBuffer(jsonStr)) req.Header.Set(\"User-Agent\", \"test\") req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\") // å‘é€è¯·æ±‚ resp, err := client.Do(req) if err != nil { slog.Error(\"POST request failed\", \"err\", err) return } defer resp.Body.Close() // è¯»å–å†…å®¹ body, err := io.ReadAll(resp.Body) if err != nil { slog.Error(\"POST request\", \"err\", err) } else { slog.Info(string(body)) } } func main() { // POST1() POSTJson() } ","date":"2023-10-09","objectID":"/posts/go-http/:2:2","tags":["Go","http"],"title":"Go Http","uri":"/posts/go-http/"},{"categories":["Kubernetes"],"content":"Dev in kubernetes â€‹ ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ä¸­ï¼Œæ˜¯ä»£ç å­˜æ”¾åœ¨æœ¬åœ°ï¼Œä½¿ç”¨ IDE è¿›è¡Œç¼–è¾‘å’Œ debug ã€‚ä½†éšç€å®¹å™¨åŒ–ç«äº†ä¹‹åï¼Œå¾ˆå¤šå•ä¸€æœåŠ¡éƒ½è¿›è¡Œäº†æ‹†åˆ†ï¼Œå¾®æœåŠ¡åŒ–ã€‚åœ¨å¼€å‘é˜¶æ®µï¼Œéœ€è¦æœ¬åœ°åŒæ—¶å¯åŠ¨å¤šä¸ªæœåŠ¡ï¼Œè¿™ä½¿å¾—æœ¬åœ°å¼€å‘è°ƒè¯•å˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚Okteto æ˜¯ä¸€ä¸ªé€šè¿‡åœ¨ Kubernetes ä¸­æ¥å¼€å‘å’Œæµ‹è¯•ä»£ç çš„åº”ç”¨ç¨‹åºå¼€å‘å·¥å…·ã€‚å¯ä»¥é€šè¿‡ Okteto åœ¨ Kubernetes ä¸­ä¸€é”®ä¸ºæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªå¼€å‘ç¯å¢ƒï¼Œéå¸¸ç®€å•æ–¹ä¾¿ã€‚Google æ¨å‡ºçš„ Skaffold åªæ˜¯æŠŠ CICD é›†æˆåˆ°æœ¬åœ°ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒå›°éš¾ã€‚Okteto çš„å·¥ä½œåŸç†æ˜¯åœ¨ kubernetes ä¸­å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼ŒæŠŠæœ¬åœ°ä»£ç åŒæ­¥åˆ° pod ä¸­ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤è®©æœåŠ¡è¿è¡Œèµ·æ¥ï¼ŒOkteto å¯ä»¥è¿›è¡Œç«¯å£çš„è½¬å‘ï¼Œè½¬å‘podé‡ŒæœåŠ¡çš„ç«¯å£åˆ°æœ¬åœ°ï¼Œåœ¨è¿›è¡Œ debug çš„æ—¶å€™ï¼Œpodé‡Œå¯åŠ¨çš„ç«¯å£å¯ä»¥è¢« kubernetes å†…çš„å…¶ä»–æœåŠ¡æ‰€è®¿é—®ï¼Œæœ¬åœ°è½¬å‘çš„ç«¯å£å¯ä»¥è¢«æœ¬åœ°çš„å·¥å…·ï¼ˆä¾‹å¦‚ postman ï¼‰è®¿é—®ã€‚ oktetoå®˜ç½‘æ–‡æ¡£ï¼šhttps://www.okteto.com/docs Go é…ç½®æ–‡æ¡£ï¼šhttps://www.okteto.com/docs/samples/golang/ ç¤ºä¾‹ç¯å¢ƒï¼š vscode 1.82.1(éœ€è¦å®‰è£… Remote - Kubernetes æ’ä»¶ï¼Œæ’ä»¶codeï¼šokteto.remote-kubernetes) k3d mac ","date":"2023-09-26","objectID":"/posts/okteto/:0:0","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["Kubernetes"],"content":"å®‰è£…ä¸é…ç½® ä¸‹è½½oktetoï¼šhttps://github.com/okteto/okteto/releases [crab@Sugar ~]ğŸ³ wget https://ghproxy.com/https://github.com/okteto/okteto/releases/download/2.20.0/okteto-Darwin-arm64 [crab@Sugar ~]ğŸ³ chmod +x okteto-Darwin-arm64 [crab@Sugar ~]ğŸ³ sudo mv okteto-Darwin-arm64 /usr/local/bin/okteto ","date":"2023-09-26","objectID":"/posts/okteto/:1:0","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["Kubernetes"],"content":"ä¸‹è½½ç¤ºä¾‹ä»£ç  [crab@Sugar ~]ğŸ³ git clone https://github.com/okteto/go-getting-started go-okteto [crab@Sugar ~]ğŸ³ cd go-okteto ","date":"2023-09-26","objectID":"/posts/okteto/:1:1","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["Kubernetes"],"content":"é…ç½®port-forwardç«¯å£ éœ€è¦è½¬å‘ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯æœåŠ¡çš„ç«¯å£ï¼Œå¦ä¸€ä¸ªæ˜¯debugä½¿ç”¨çš„ç«¯å£ okteto.yaml build: hello-world: image: serialt/go-hello-world:1.0.0 context: . deploy: - kubectl apply -f k8s.yml dev: hello-world: # è¢«æ›¿æ¢çš„æœåŠ¡å image: okteto/golang:1 command: bash sync: - .:/usr/src/app volumes: - /go - /root/.cache securityContext: capabilities: add: - SYS_PTRACE forward: - 2345:2345 - 8080:8080 # \u003c---- å¢åŠ 8080æœåŠ¡ç«¯å£è½¬å‘ è®¾ç½®okteto contextï¼Œokteto é»˜è®¤ä¼šä¼˜å…ˆä½¿ç”¨KUBECONFIGç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™ä½¿ç”¨ ~/.kube/configæ–‡ä»¶ [crab@Sugar go-okteto]ğŸ³ okteto context âœ“ Context 'k3d-mycluster' selected âœ“ Using dev @ k3d-mycluster ","date":"2023-09-26","objectID":"/posts/okteto/:1:2","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["Kubernetes"],"content":"å¯åŠ¨æœåŠ¡ [crab@Sugar go-okteto]ğŸ³ okteto up i Using dev @ k3d-mycluster as context i 'go-getting-started' was already deployed. To redeploy run 'okteto deploy' or 'okteto up --deploy' i Images were already built. To rebuild your images run 'okteto build' or 'okteto deploy --build' âœ“ Images successfully pulled âœ“ Files synchronized Context: k3d-mycluster Namespace: dev Name: hello-world Forward: 2345 -\u003e 2345 8080 -\u003e 8080 Welcome to your development container. Happy coding! dev:hello-world app\u003e dev:hello-world app\u003e ls Dockerfile LICENSE Makefile README.md bashrc go.mod k8s.yml main.go okteto.yml ","date":"2023-09-26","objectID":"/posts/okteto/:1:3","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["Kubernetes"],"content":"è¿œç¨‹å¼€å‘ # oktetoç»ˆç«¯ dev:hello-world app\u003e go run main.go Starting hello-world server... # ç»ˆç«¯æµ‹è¯• [crab@Sugar ~]ğŸ³ curl 127.0.0.1:8080 Hello world! ","date":"2023-09-26","objectID":"/posts/okteto/:1:4","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["Kubernetes"],"content":"è¿œç¨‹è°ƒè¯• # oktetoç»ˆç«¯, æ‰§è¡Œdlvå‘½ä»¤ dev:hello-world app\u003e dlv debug --headless --listen=:2345 --log --api-version=2 API server listening at: [::]:2345 2023-09-26T13:40:51Z warning layer=rpc Listening for remote connections (connections are not authenticated nor encrypted) 2023-09-26T13:40:51Z info layer=debugger launching process with args: [./__debug_bin3213431902] 2023-09-26T13:40:51Z debug layer=debugger Adding target 575 \"/usr/src/app/__debug_bin3213431902\" # main.go æ‰“ä¸Šdebugæ ‡è®° func helloServer(w http.ResponseWriter, r *http.Request) { fmt.Fprint(w, \"Hello world from Okteto!, k3d is great! \") fmt.Println(\"okteto ccccccc\") # æ ‡è®°æ­¤è¡Œ } åœ¨vscode debugä¸­ç‚¹å‡»å¼€å§‹debug ä½¿ç”¨å‘½ä»¤è¯·æ±‚ http://127.0.0.1:8080ï¼Œå³å¯debugåˆ°æ ‡è®°ç‚¹ [sugar@Sugar go-okteto]ğŸ³ curl http://127.0.0.1:8080 Hello world from Okteto!, k3d is great! ","date":"2023-09-26","objectID":"/posts/okteto/:1:5","tags":["okteto","kubernetes","vscode","dev"],"title":"Okteto","uri":"/posts/okteto/"},{"categories":["vscode"],"content":"Debug shell 1ã€å®‰è£…æ’ä»¶ å®‰è£…bashdbæ’ä»¶ rogalmic.bash-debug 2ã€å¢åŠ ä¸€ä¸ªvscode launch.jsoné…ç½®æ–‡ä»¶ Select Debug -\u003e Add Configuration to add custom debug configuration ç¤ºä¾‹ï¼š { \"configurations\": [ { \"type\": \"bashdb\", \"request\": \"launch\", \"name\": \"Bash-Debug\", \"cwd\": \"${workspaceFolder}\", \"program\": \"${workspaceFolder}/ccc.sh\", \"args\": [] }, ] } å°±å¯ä»¥åƒdebugå…¶ä»–è¯­è¨€ä¸€æ ·è¿›è¡Œè°ƒè¯•shellè„šæœ¬ ","date":"2023-09-24","objectID":"/posts/debug-shell-in-vscode/:0:0","tags":["shell"],"title":"Debug Shell in VSCode","uri":"/posts/debug-shell-in-vscode/"},{"categories":["mirror-web"],"content":"æ¸…åé•œåƒç½‘é¡µæ­å»ºé•œåƒç«™ tuna mirror-webåœ°å€ï¼šhttps://github.com/tuna/mirror-web.git tuna mirror-webåŸºäºjekyllå¼€å‘ï¼Œç”±äºrubyç¯å¢ƒå®‰è£…å¤æ‚ï¼Œå› æ­¤é‡‡ç”¨dockerç¼–è¯‘ï¼Œä½†åœ¨buildé•œåƒçš„æ—¶å€™ï¼Œå‡ºç°å®‰è£…åŒ…ä¾èµ–å®‰è£…å¤±è´¥ï¼Œåœ¨å¤šæ¬¡æµ‹è¯•åï¼Œæ— æ³•buildæˆé•œåƒã€‚å‰æ®µæ—¶é—´ï¼Œåœ¨æŸ¥çœ‹mirror-webæ®µissuesæ—¶ï¼Œæœ‰äººè¯¢é—®mirror-webæ®µREADME.mdæ–‡æ¡£çš„ä¸‹ä¸€æ­¥ï¼Œå®˜æ–¹ç»™äº†ä¸€ç‚¹æç¤ºï¼Œæœ‰å…³äºåŸºäºnginxçš„ç¬¬ä¸‰æ–¹æ¨¡å—æ¥å®ç°ç›®å½•ç¬¬æ¸²æŸ“çš„æç¤ºè¯´æ˜ï¼Œå†æ¬¡å°è¯•åï¼Œç»å†å„ç§å›°éš¾å’ŒæŠ˜ç£¨ï¼Œç»ˆäºæ‘¸ç´¢å‡ºã€‚ ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:0","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"1ã€ä¸‹è½½mirror-webçš„jekyllç¼–è¯‘ç¯å¢ƒ tunaçš„ç¼–è¯‘é•œåƒï¼štunathu/mirror-web åœ¨ä¸‹è½½tunathu/mirror-webæ—¶å‘ç”Ÿäº†ä¸€ä¸ªå°é—®é¢˜ï¼Œç”±äºåœ¨å›½å†…ä½¿ç”¨çš„dockeré•œåƒåŠ é€Ÿï¼Œä¸‹è½½çš„é•œåƒæ˜¯æ—§ç‰ˆæœ¬çš„ï¼Œä½†å¢ƒå¤–çš„æœåŠ¡å™¨ä¸‹è½½çš„é•œåƒæ˜¯æœ€æ–°çš„ï¼Œåœ¨è¸©å‘åæœæ–­æ¨åˆ°è‡ªå·±çš„dockerhubä¸Šï¼Œæ–°çš„ä¸‹è½½åœ°å€ï¼šserialt/tuna-mirror-webã€‚ ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:1","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"2ã€ä¸‹è½½githubä»“åº“ git clone https://github.com/tuna/mirror-web.git /opt/mirror-web ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:2","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"3ã€ä¸‹è½½é¢å¤–èµ„æºå’Œç¼–è¯‘ cd /opt/mirror-web wget https://mirrors.tuna.tsinghua.edu.cn/static/tunasync.json -O static/tunasync.json wget https://mirrors.tuna.tsinghua.edu.cn/static/tunet.json -O static/tunet.json mkdir -p static/status wget https://mirrors.tuna.tsinghua.edu.cn/static/status/isoinfo.json -O static/status/isoinfo.json docker run -it -v /opt/mirror-web/:/data serialt/tuna-mirror-web:20211006 ç¼–è¯‘çš„åé™æ€æ–‡ä»¶åœ¨_siteé‡Œ ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:3","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"4ã€ç¼–è¯‘nginx éœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å— modules/ngx_http_js_module.so modules/ngx_http_fancyindex_module.so [root@serialt nginx]# ll æ€»ç”¨é‡ 1068 drwxr-xr-x 9 sonar sonar 186 10æœˆ 5 22:27 nginx-1.20.1 -rw-r--r-- 1 root root 1061461 5æœˆ 25 23:34 nginx-1.20.1.tar.gz drwxrwxr-x 3 root root 217 10æœˆ 27 2020 ngx-fancyindex-0.5.1 -rw-r--r-- 1 root root 25148 10æœˆ 27 2020 ngx-fancyindex-0.5.1.tar.xz drwxr-xr-x 10 root root 228 10æœˆ 6 15:49 njs # njsä¸‹è½½ git clone https://github.com/nginx/njs # ngx-fancyindex ä¸‹è½½ wget https://github.com/aperezdc/ngx-fancyindex/releases/download/v0.5.1/ngx-fancyindex-0.5.1.tar.xz ç¼–è¯‘ï¼š [root@serialt nginx]# ls nginx-1.20.1 nginx-1.20.1.tar.gz ngx-fancyindex-0.5.1 ngx-fancyindex-0.5.1.tar.xz njs [root@serialt nginx]# cd nginx-1.20.1/ [root@serialt nginx-1.20.1]# ./configure --prefix=/usr/local/nginx --with-pcre --with-http_auth_request_module --with-http_ssl_module --with-http_v2_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-mail --with-mail_ssl_module --with-stream --with-stream_ssl_module --with-stream_realip_module --add-dynamic-module=/root/nginx/ngx-fancyindex-0.5.1 --add-dynamic-module=/root/nginx/njs/nginx # add m 3997 [2022-02-25 00:49:21] [root] [10.5.0.10] ./configure --with-compat --add-dynamic-module=/root/github/tuna-mirror-web/njs-0.6.2/nginx 3998 [2022-02-25 00:49:31] [root] [10.5.0.10] make modules nginxé…ç½®æ–‡ä»¶å†…å®¹ [root@serialt mirrors]# cat /usr/local/nginx/conf/nginx.conf #user nobody; worker_processes 1; #error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; #pid logs/nginx.pid; load_module modules/ngx_http_js_module.so; load_module modules/ngx_http_fancyindex_module.so; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; #log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' # '$status $body_bytes_sent \"$http_referer\" ' # '\"$http_user_agent\" \"$http_x_forwarded_for\"'; #access_log logs/access.log main; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; map $http_user_agent $isbrowser { default 0; \"~*validation server\" 0; \"~*mozilla\" 1; } js_path /opt/mirror-web/_site/static/njs; js_include /opt/mirror-web/_site/static/njs/all.njs; #js_path /opt/mirror-web/static/njs; #js_include /opt/mirror-web/static/njs/all.njs; server { listen 8007; server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; #root /opt/mirror-web/_site; fancyindex_header /fancy-index/before; fancyindex_footer /fancy-index/after; fancyindex_exact_size off; fancyindex_time_format \"%d %b %Y %H:%M:%S +0000\"; fancyindex_name_length 256; error_page 404 /404.html; location /fancy-index { internal; root /opt/mirror-web/_site; subrequest_output_buffer_size 100k; location = /fancy-index/before { js_content fancyIndexBeforeRender; } location = /fancy-index/after { js_content fancyIndexAfterRender; } } location / { root /opt/mirror-web/_site; index index.html index.htm; #try_files /_site/$uri $uri/ /_site/$uri; fancyindex on; } # location / { # root html; # index index.html index.htm; # } #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } } [root@serialt mirrors]# ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:4","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"5ã€é•œåƒèµ„æºæš´éœ² æ–¹æ³•1ï¼šä»¥è½¯é“¾æ¥å½¢å¼å­˜æ”¾åœ¨/opt/mirror-web/_siteä¸­ [root@serialt _site]# pwd /opt/mirror-web/_site [root@serialt _site]# ll æ€»ç”¨é‡ 160 -rw-r--r-- 1 root root 16415 10æœˆ 6 15:37 404.html drwxr-xr-x 2 root root 6 10æœˆ 6 17:14 cc drwxr-xr-x 2 root root 19 10æœˆ 6 17:14 centos drwxr-xr-x 2 root root 94 10æœˆ 6 09:25 fancy-index -rw-r--r-- 1 root root 36650 10æœˆ 6 15:37 feed.xml drwxr-xr-x 103 root root 4096 10æœˆ 6 09:25 help -rw-r--r-- 1 root root 27679 10æœˆ 6 15:37 index.html -rw-r--r-- 1 root root 20728 10æœˆ 6 15:37 legacy_index.html -rw-r--r-- 1 root root 18092 10æœˆ 6 15:37 LICENSE drwxr-xr-x 47 root root 4096 10æœˆ 6 09:25 news -rw-r--r-- 1 root root 58 10æœˆ 6 15:37 robots.txt -rw-r--r-- 1 root root 19134 10æœˆ 6 15:37 sitemap.xml drwxr-xr-x 8 root root 115 10æœˆ 6 15:37 static drwxr-xr-x 2 root root 24 10æœˆ 6 09:25 status æ–¹æ³•äºŒï¼šæŠŠ/opt/mirror-web/_siteé‡Œçš„æ–‡ä»¶ä»¥è½¯é“¾æ¥çš„æ–¹å¼é“¾æ¥åˆ°é•œåƒçš„è·Ÿç›®å½•ï¼ˆå»ºè®®ä½¿ç”¨ï¼‰ ln -snf /opt/mirror-web/_site/* /opt/imau ç›®å½•æè¿°æ–‡ä»¶ï¼š_data/options.yml ç«™ç‚¹èµ„æºæ˜¾ç¤ºæ§åˆ¶ï¼šstatic/tunasync.json tunasync.json [ { \"name\": \"ant\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"book\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"centos\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"dev\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"frp\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"git\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"go\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"grafana\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"iso\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"jdk\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"jmeter\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"kubernetes\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"mac\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"monitor\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"node\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"root-ca\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"other\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"printer\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"prometheus\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"pycharm\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"python\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"repo\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"script\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"test\", \"is_master\": true, \"status\": \"success\" }, { \"name\": \"tool\", \"is_master\": true, \"status\": \"success\" } ] \"last_update\": \"2022-01-11 16:39:37 +0800\", \"last_update_ts\": 1641890377, \"last_started\": \"2022-01-11 16:39:21 +0800\", \"last_started_ts\": 1641890361, \"last_ended\": \"2022-01-11 16:39:37 +0800\", \"last_ended_ts\": 1641890377, \"next_schedule\": \"2022-01-11 22:39:37 +0800\", \"next_schedule_ts\": 1641911977, \"upstream\": \"rsync://msync.centos.org/CentOS/\", - status: 'success' last_update: '-' name: \"AUR\" url: 'https://aur.tuna.tsinghua.edu.cn/' upstream: 'https://aur.archlinux.org/' is_master: true options.yml # Content Related mirror_desc: - name: git desc: git äºŒè¿›åˆ¶ç¼–è¯‘ç‰ˆæœ¬ - name: go desc: golang å¼€å‘ç¯å¢ƒ - name: grafana desc: grafana çš„å®‰è£…åŒ… - name: helm desc: helm çš„äºŒè¿›åˆ¶å‘è¡ŒåŒ… - name: ios desc: é•œåƒæ–‡ä»¶ï¼Œå¦‚centos, ubuntu, rockyç­‰ - name: jdk desc: java å¼€å‘ç¯å¢ƒå®‰è£…åŒ… new_mirrors: - hugging-face-models - endeavouros - ubuntukylin - putty - postmarketOS - postmarketOS-images - obs-studio - stellarium unlisted_mirrors: - status: 'success' last_update: '-' name: \"AUR\" url: 'https://aur.tuna.tsinghua.edu.cn/' upstream: 'https://aur.archlinux.org/' is_master: true - link_to: 'osdn' name: \"manjaro-cd\" url: '/osdn/storage/g/m/ma/manjaro/' - link_to: 'osdn' name: \"manjaro-arm-cd\" url: '/osdn/storage/g/m/ma/manjaro-arm/' - link_to: 'osdn' name: \"mxlinux-isos\" url: '/osdn/storage/g/m/mx/mx-linux/ISOs/' - link_to: 'osdn' name: \"garuda-linux\" url: '/osdn/storage/g/g/ga/garuda-linux/' - link_to: 'osdn' name: \"linuxlite-cd\" url: '/osdn/storage/g/l/li/linuxlite/' - link_to: 'github-release' name: \"prometheus\" url: '/github-rele","date":"2023-09-24","objectID":"/posts/tuna-web/:1:5","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"6ã€dockeré•œåƒä½¿ç”¨ é™æ€æ–‡ä»¶ç¼–è¯‘ æ„å»º Jekyll çš„ docker é•œåƒç¯å¢ƒå¤æ‚ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨å®˜æ–¹æˆ–è€…å·²ç»å­˜åœ¨çš„é•œåƒtunathu/mirror-webæˆ–è€…serialt/tuna-mirror-web [root@tc ~]# docker run -it -v /path/to/mirror-web/:/data serialt/tuna-mirror-web ä¸€äº›åŠ¨æ€æ•°æ®å·²ç»ä¸‹è½½ï¼Œè‹¥éœ€è¦æœ€æ–°çš„ï¼Œå¯ä»¥å°±è¡Œä»¥ä¸‹æ“ä½œ,ç„¶ååœ¨æ„å»º ä¸‹è½½æœ€æ–°çš„åŠ¨æ€æ•°æ®æ–‡ä»¶ wget https://mirrors.tuna.tsinghua.edu.cn/static/tunasync.json -O static/tunasync.json wget https://mirrors.tuna.tsinghua.edu.cn/static/tunet.json -O static/tunet.json mkdir -p static/status wget https://mirrors.tuna.tsinghua.edu.cn/static/status/isoinfo.json -O static/status/isoinfo.json è¿è¡ŒæœåŠ¡ dockeré•œåƒç½‘é¡µæ ¹ç›®å½•: /opt/mirror-web é•œåƒç«™èµ„æºæ ¹ç›®å½•: /opt/mirror å¯åŠ¨æœåŠ¡ docker run -tid -v /opt/tuna-mirror-web/_site:/opt/mirror-web -v /opt/mirror:/opt/mirror -p 8099:80 --name=tuna-mirror-nginx serialt/tuna-mirror-web-nginx:7b0c89d version: \"3\" networks: tuna-mirror-nginx: external: false services: tuna-mirror-nginx: image: serialt/tuna-mirror-web-nginx:latest container_name: mirror-nginx hostname: mirror-nginx restart: always networks: - tuna-mirror-nginx volumes: - \"/etc/localtime:/etc/localtime:ro\" - \"/opt/mirror-web/_site:/opt/mirror-web\" - \"/opt/mirror:/opt/mirror\" ports: - \"80:80\" dns: - 223.5.5.5 - 223.6.6.6 ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:6","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"æ–°é•œåƒç«™ç‰ˆæœ¬å‘å¸ƒ docker run -it --rm -v /opt/tuna-mirror-web:/data serialt/tuna-mirror-web docker restart tuna-mirror-nginx ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:7","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"ç¼–å†™è¯´æ˜ _data/options.yml: æ˜¯æ˜¾ç¤ºåœ¨é•œåƒç«™ä¸»é¡µå¯¹å„ä¸ªç›®å½•çš„è¯´æ˜ static/tunasync.json: æ˜¯å¯¹å½“å‰repoçš„åŒæ­¥ä¿¡æ¯çš„æè¿°ï¼Œå¯ä»¥è‡ªè¡Œç¼–è¾‘ï¼Œä¹Ÿå¯ä»¥ä»tunaä¸Šä¸‹è½½ help: helpç›®å½•é‡Œå­˜æœ‰å„ä¸ªrepoçš„å¸®åŠ©ä¿¡æ¯ï¼Œåœ¨ä¸»é¡µä¸Šä¼šæ˜¾ç¤ºæœ‰ä¸ª\"?\" news: é•œåƒç«™çš„æ–°é—»ä¿¡æ¯ ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:8","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["mirror-web"],"content":"help è¯´æ˜ permalink æ˜¯è¡¨ç¤ºhelpçš„é¦–é¡µçš„è·¯å¾„ï¼Œå¿…é¡»è¦æœ‰ --- layout: help category: help mirrorid: app permalink: /help/app/ --- ","date":"2023-09-24","objectID":"/posts/tuna-web/:1:9","tags":["mirrors"],"title":"Tuna Web","uri":"/posts/tuna-web/"},{"categories":["Kubernetes"],"content":"helm oci ","date":"2023-09-24","objectID":"/posts/helm-migrate-oci/:1:0","tags":["helm"],"title":"Helm Migrate OCI","uri":"/posts/helm-migrate-oci/"},{"categories":["Kubernetes"],"content":"ç¼˜ç”± Helm 3.8 ç‰ˆæœ¬å¼€å§‹ï¼Œæ”¯æŒä½¿ç”¨ociè¿›è¡Œå­˜å‚¨chartã€‚é•œåƒå­˜å‚¨å¸¸ç”¨çš„Harboråœ¨v1.6ç‰ˆæœ¬å¼€å§‹æ”¯æŒHelm Chartä»“åº“åŠŸèƒ½ï¼Œ chartä»“åº“ç”±chartmuseumä»¥æ’ä»¶çš„æ–¹å¼æä¾›ã€‚éšç€å…¼å®¹OCIè§„èŒƒçš„Helm Chartåœ¨ç¤¾åŒºä¸Šè¢«æ›´å¹¿æ³›åœ°æ¥å—ï¼ŒHelm Chartèƒ½ä»¥Artifactçš„å½¢å¼åœ¨Harborä¸­å­˜å‚¨å’Œç®¡ç†ï¼Œä¸å†ä¾èµ–ChartMuseumï¼Œå› æ­¤Harboråœ¨v2.8.0ç‰ˆæœ¬ä¸­ï¼Œç§»é™¤å¯¹ChartMuseumçš„æ”¯æŒã€‚ ","date":"2023-09-24","objectID":"/posts/helm-migrate-oci/:1:1","tags":["helm"],"title":"Helm Migrate OCI","uri":"/posts/helm-migrate-oci/"},{"categories":["Kubernetes"],"content":"registry ä»“åº“ä½¿ç”¨ åŸºæœ¬ä½¿ç”¨ ### registry # ç™»å½• helm registry login -u serialt docker.io # æ³¨é”€ helm registry logout docker.io # pull chart helm fetch oci://docker.io/serialt/loki-stack --version=2.9.11 # push chart helm push loki-stack-2.9.11.tgz oci://docker.io/serialt ociæ”¯æŒçš„å…¶ä»–å‘½ä»¤ helm pull helm show helm template helm install helm upgrade $ helm pull oci://localhost:5000/helm-charts/mychart --version 0.1.0 Pulled: localhost:5000/helm-charts/mychart:0.1.0 Digest: sha256:0be7ec9fb7b962b46d81e4bb74fdcdb7089d965d3baca9f85d64948b05b402ff $ helm show all oci://localhost:5000/helm-charts/mychart --version 0.1.0 apiVersion: v2 appVersion: 1.16.0 description: A Helm chart for Kubernetes name: mychart ... $ helm template myrelease oci://localhost:5000/helm-charts/mychart --version 0.1.0 --- # Source: mychart/templates/serviceaccount.yaml apiVersion: v1 kind: ServiceAccount ... $ helm install myrelease oci://localhost:5000/helm-charts/mychart --version 0.1.0 NAME: myrelease LAST DEPLOYED: Wed Oct 27 15:11:40 2021 NAMESPACE: default STATUS: deployed REVISION: 1 NOTES: ... $ helm upgrade myrelease oci://localhost:5000/helm-charts/mychart --version 0.2.0 Release \"myrelease\" has been upgraded. Happy Helming! NAME: myrelease LAST DEPLOYED: Wed Oct 27 15:12:05 2021 NAMESPACE: default STATUS: deployed REVISION: 2 NOTES: ... ","date":"2023-09-24","objectID":"/posts/helm-migrate-oci/:1:2","tags":["helm"],"title":"Helm Migrate OCI","uri":"/posts/helm-migrate-oci/"},{"categories":["Kubernetes"],"content":"è¿ç§» chart repo åˆ° oci ä»“åº“ åŸºäº github action é•œåƒ helm repo ä»“åº“åˆ° docker hubï¼Œä»¥åŠ é€Ÿ helm repo åˆ°è®¿é—®ã€‚ migrate-chart ","date":"2023-09-24","objectID":"/posts/helm-migrate-oci/:1:3","tags":["helm"],"title":"Helm Migrate OCI","uri":"/posts/helm-migrate-oci/"}]